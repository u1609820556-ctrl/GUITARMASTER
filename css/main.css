        :root {
            /* Studio Vinyl Modernist Palette */
            --vinyl-black: #0a0a0a;
            --studio-gray: #1a1a1a;
            --tape-red: #dc2626;
            --vumeter-green: #10b981;
            --steel: #404040;
            --chrome: #888888;
            --paper: #fafafa;
            --key-highlight: #eab308;
            --chord-active: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Barlow Condensed', sans-serif;
            background: #0a0a0a;
            color: #e5e5e5;
            min-height: 100vh;
            overflow-x: hidden;
            letter-spacing: 0.02em;
        }

        /* Noise texture overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.035;
            z-index: 9999;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* Custom scrollbar - industrial */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #121212;
            border-left: 1px solid #252525;
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #dc2626 0%, #991b1b 100%);
            border: 1px solid #0a0a0a;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #ef4444 0%, #b91c1c 100%);
        }

        /* Fretboard styles - dark rosewood industrial with rounded */
        /* Sticky wrapper for fretboard - always visible at top */
        .fretboard-sticky-wrapper {
            position: sticky;
            top: 64px;
            z-index: 100;
            background: linear-gradient(180deg, #0a0807 0%, #060400 100%);
            padding: 1rem 0;
            margin-bottom: 1rem;
            border-bottom: 2px solid rgba(115, 115, 65, 0.2);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        /* Level 2 — limitar altura del panel para que los licks no empujen el diapasón */
        body[data-level="2"] #controlPanel {
            max-height: 44vh;
            overflow-y: auto;
        }

        /* Level 5 */
        body[data-level="5"] #infoPanelOtherLevels { display: none !important; }
        body[data-level="5"] #level3TopSection { display: none !important; }
        body[data-level="5"] #controlPanel {
            padding: 6px 16px !important;
            max-height: calc(100vh - 64px - 220px); /* dejar espacio para fretboard */
            overflow-y: auto !important;
            overflow-x: hidden !important;
        }
        /* Circle layout */
        body[data-level="5"] #circleMainRow {
            align-items: flex-start !important;
            flex-wrap: nowrap !important;
        }
        body[data-level="5"] #circleWrapOuter,
        body[data-level="5"] #circleOfFifthsMain {
            width: 300px !important;
            height: 300px !important;
            flex-shrink: 0 !important;
        }
        body[data-level="5"] #circleRelationSvg {
            width: 300px !important;
            height: 300px !important;
        }
        /* Circle nodes */
        body[data-level="5"] .circle-note {
            width: 38px; height: 38px; font-size: 13px;
        }
        body[data-level="5"] .circle-note.minor {
            width: 28px; height: 28px; font-size: 10px;
        }
        /* Side panel text — compacto pero legible */
        body[data-level="5"] #circleSidePanel {
            font-size: 13px;
            overflow-y: visible;
        }
        body[data-level="5"] #circleSidePanel .scale-info-box {
            padding: 8px 10px;
        }
        body[data-level="5"] #circleSidePanel .info-header { margin-bottom: 6px; }
        body[data-level="5"] #circleSidePanel .info-title { font-size: 17px; line-height: 1.2; }
        body[data-level="5"] #circleSidePanel .info-emotion { font-size: 12px; margin-top: 1px; }
        body[data-level="5"] #circleSidePanel .info-label { font-size: 11px; margin-bottom: 3px; }
        body[data-level="5"] #circleSidePanel .info-value { font-size: 15px; }
        body[data-level="5"] #circleSidePanel .info-description { font-size: 13px; line-height: 1.4; }
        body[data-level="5"] #circleSidePanel .info-section { padding: 5px 8px; margin-bottom: 4px; }
        body[data-level="5"] #circleSidePanel .grid { gap: 5px !important; }

        /* Hide main fretboard when in Chord Lab (uses integrated one) */
        body[data-level="11"] .fretboard-sticky-wrapper {
            display: none;
        }

        /* Hide display title/subtitle in Chord Lab */
        body[data-level="11"] #mainFretboardArea > .mb-6.text-center {
            display: none;
        }

        /* Hide the entire main fretboard area in Chord Lab */
        body[data-level="11"] #mainFretboardArea {
            display: none;
        }


        .fretboard-container {
            background: linear-gradient(180deg, #1a1412 0%, #0d0a08 100%);
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #333;
            box-shadow:
                inset 0 0 60px rgba(0,0,0,0.8),
                0 0 0 1px #0a0a0a,
                0 20px 60px rgba(0,0,0,0.7);
        }

        .fretboard-container::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image:
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E"),
                repeating-linear-gradient(90deg, transparent 0px, transparent 40px, rgba(0,0,0,0.1) 40px, rgba(0,0,0,0.1) 41px);
            opacity: 0.12;
            pointer-events: none;
        }

        .string {
            position: relative;
            display: flex;
            align-items: center;
            height: 42px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.02);
        }

        .string::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            height: 2px;
            background: linear-gradient(90deg,
                rgba(200, 180, 160, 0.2) 0%,
                rgba(220, 200, 180, 0.7) 8%,
                rgba(200, 180, 160, 0.5) 50%,
                rgba(180, 160, 140, 0.3) 100%
            );
            transform: translateY(-50%);
            box-shadow: 0 1px 3px rgba(0,0,0,0.6);
        }

        /* Visual representation: thin strings at top (high E), thick at bottom (low E) */
        .string:nth-child(1)::before { height: 1px; opacity: 0.85; }
        .string:nth-child(2)::before { height: 1.5px; opacity: 0.8; }
        .string:nth-child(3)::before { height: 2px; opacity: 0.75; }
        .string:nth-child(4)::before { height: 2.5px; opacity: 0.7; background: linear-gradient(90deg, rgba(180, 165, 150, 0.2) 0%, rgba(190, 175, 160, 0.65) 8%, rgba(170, 155, 140, 0.45) 50%, rgba(160, 145, 130, 0.25) 100%); }
        .string:nth-child(5)::before { height: 3px; opacity: 0.65; background: linear-gradient(90deg, rgba(160, 150, 140, 0.2) 0%, rgba(170, 160, 150, 0.55) 8%, rgba(150, 140, 130, 0.35) 50%, rgba(140, 130, 120, 0.18) 100%); }
        .string:nth-child(6)::before { height: 3.5px; opacity: 0.6; background: linear-gradient(90deg, rgba(150, 140, 130, 0.2) 0%, rgba(160, 150, 140, 0.45) 8%, rgba(140, 130, 120, 0.28) 50%, rgba(130, 120, 110, 0.15) 100%); }

        .fret {
            position: relative;
            flex: 1;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 3px solid #555;
            box-shadow: inset -2px 0 6px rgba(0,0,0,0.4), inset 2px 0 4px rgba(255,255,255,0.02);
        }

        .fret:first-child {
            flex: 0.6;
            background: linear-gradient(90deg, #f0ead6 0%, #d8cdb8 50%, #c4b89a 100%);
            border-right: 6px solid #1a1a1a;
            box-shadow: inset -4px 0 10px rgba(0,0,0,0.5), 4px 0 12px rgba(0,0,0,0.4);
        }

        .fret-marker {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 12px;
            background: radial-gradient(circle, #e8e0d0 0%, #b8a888 100%);
            border-radius: 50%;
            opacity: 0.8;
            box-shadow: 0 2px 4px rgba(0,0,0,0.4);
        }

        .note-bubble {
            position: relative;
            z-index: 10;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            opacity: 0;
            transform: scale(0);
            text-transform: uppercase;
        }

        .note-bubble.visible {
            opacity: 1;
            transform: scale(1);
        }

        .note-bubble.tonic {
            background: #dc2626;
            color: #fafafa;
            box-shadow:
                0 0 0 3px #0a0a0a,
                0 0 20px rgba(220, 38, 38, 0.6),
                0 4px 15px rgba(0,0,0,0.4);
            border: none;
        }

        .note-bubble.interval {
            background: #fafafa;
            color: #0a0a0a;
            box-shadow:
                0 0 0 2px #0a0a0a,
                0 4px 12px rgba(0,0,0,0.4);
            border: none;
        }

        .note-bubble.other {
            background: #444;
            color: #bbb;
            box-shadow:
                0 2px 8px rgba(0,0,0,0.3);
            border: none;
        }

        .note-bubble:hover {
            transform: scale(1.2);
            z-index: 20;
        }

        /* Finger badge on note bubbles */
        .finger-badge {
            position: absolute;
            bottom: -8px;
            right: -8px;
            width: 18px;
            height: 18px;
            background: #3b82f6;
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 700;
            border: 2px solid #0a0a0a;
            box-shadow: 0 2px 6px rgba(0,0,0,0.4);
            z-index: 15;
        }

        /* CAGED position highlights */
        .fret.caged-c {
            background: rgba(220, 38, 38, 0.1);
            border-left: 3px solid #dc2626;
        }

        .fret.caged-a {
            background: rgba(234, 88, 12, 0.1);
            border-left: 3px solid #ea580c;
        }

        .fret.caged-g {
            background: rgba(234, 179, 8, 0.1);
            border-left: 3px solid #eab308;
        }

        .fret.caged-e {
            background: rgba(34, 197, 94, 0.1);
            border-left: 3px solid #22c55e;
        }

        .fret.caged-d {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #3b82f6;
        }

        /* CAGED SVG node styles */
        .caged-node {
            transition: all 0.3s ease;
        }

        .caged-node:hover circle {
            filter: brightness(1.2);
            cursor: pointer;
        }

        .caged-node.active circle {
            stroke: #84cc16 !important;
            stroke-width: 4 !important;
        }

        .caged-connection {
            transition: all 0.3s ease;
        }

        .caged-connection:hover {
            stroke: #94a3b8 !important;
            stroke-width: 3 !important;
            cursor: pointer;
        }

        /* Position marker label */
        .position-marker {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: 700;
            font-family: 'IBM Plex Mono', monospace;
            padding: 4px 8px;
            border-radius: 4px;
            white-space: nowrap;
            z-index: 5;
        }

        .position-marker.caged-c {
            background: #dc2626;
            color: #fff;
        }

        .position-marker.caged-a {
            background: #ea580c;
            color: #fff;
        }

        .position-marker.caged-g {
            background: #eab308;
            color: #000;
        }

        .position-marker.caged-e {
            background: #22c55e;
            color: #000;
        }

        .position-marker.caged-d {
            background: #3b82f6;
            color: #fff;
        }

        /* Picking direction animations */
        @keyframes pickDown {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(5px); }
        }

        @keyframes pickUp {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .note-bubble.pick-down {
            animation: pickDown 0.3s ease-in-out;
        }

        .note-bubble.pick-up {
            animation: pickUp 0.3s ease-in-out;
        }

        /* Level cards - industrial with rounded */
        .level-card {
            background: #121212;
            border: 2px solid #252525;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .level-card:hover {
            border-color: #444;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }

        .level-card.active {
            border-color: #dc2626;
            box-shadow: 0 0 30px rgba(220, 38, 38, 0.2);
        }

        .level-header {
            padding: 16px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background 0.2s ease;
            border-left: 4px solid transparent;
        }

        .level-header:hover {
            background: rgba(255,255,255,0.03);
            border-left-color: #dc2626;
        }

        .level-content {
            display: grid;
            grid-template-rows: 0fr;
            transition: grid-template-rows 0.35s ease;
            overflow: hidden;
        }

        .level-content > * {
            min-height: 0;
        }

        .level-card.expanded .level-content {
            grid-template-rows: 1fr;
        }

        .collapsible-panel {
            display: grid;
            grid-template-rows: 1fr;
            transition: grid-template-rows 0.3s ease, opacity 0.3s ease;
            overflow: hidden;
            opacity: 1;
        }

        .collapsible-panel > * {
            min-height: 0;
        }

        .collapsible-panel.collapsed {
            grid-template-rows: 0fr;
            opacity: 0;
        }

        .level-badge {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Bebas Neue', sans-serif;
            font-weight: 400;
            font-size: 18px;
            letter-spacing: 1px;
        }

        /* Buttons - industrial with rounded */
        .btn-primary {
            background: #dc2626;
            color: #fafafa;
            padding: 14px 28px;
            border-radius: 10px;
            font-family: 'Bebas Neue', sans-serif;
            font-weight: 400;
            font-size: 17px;
            letter-spacing: 2px;
            text-transform: uppercase;
            border: 2px solid #dc2626;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 12px;
        }

        .btn-primary:hover {
            background: transparent;
            color: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: #e5e5e5;
            padding: 12px 22px;
            border-radius: 8px;
            font-family: 'Barlow Condensed', sans-serif;
            font-weight: 600;
            font-size: 15px;
            letter-spacing: 1.2px;
            text-transform: uppercase;
            border: 2px solid #444;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-secondary:hover {
            border-color: #dc2626;
            color: #dc2626;
        }

        /* Select dropdown - industrial with rounded */
        .custom-select {
            appearance: none;
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 12px 44px 12px 16px;
            color: #fafafa;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23dc2626'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 18px;
            transition: all 0.15s ease;
        }

        .custom-select:hover {
            border-color: #555;
        }

        .custom-select:focus {
            outline: none;
            border-color: #dc2626;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.15);
        }

        /* Toggle switch - industrial with rounded */
        .toggle-switch {
            position: relative;
            width: 48px;
            height: 26px;
            background: #252525;
            border-radius: 13px;
            border: 2px solid #333;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .toggle-switch.active {
            background: #dc2626;
            border-color: #dc2626;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 18px;
            height: 18px;
            background: #fafafa;
            border-radius: 50%;
            transition: transform 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .toggle-switch.active::after {
            transform: translateX(22px);
        }

        /* Interval buttons - industrial with rounded */
        .interval-btn {
            padding: 10px 16px;
            border-radius: 8px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            border: 2px solid #333;
            background: #1a1a1a;
            color: #999;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .interval-btn:hover {
            border-color: #666;
            color: #fafafa;
            background: #252525;
        }

        .interval-btn.active {
            background: #fafafa;
            color: #0a0a0a;
            border-color: #fafafa;
            font-weight: 700;
        }

        /* Color-coding por consonancia */
        .interval-btn[data-consonance="perfect-consonant"] {
            border-color: #10b981;
        }
        .interval-btn[data-consonance="perfect-consonant"]:hover,
        .interval-btn[data-consonance="perfect-consonant"].active {
            border-color: #10b981;
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.4);
        }

        .interval-btn[data-consonance="imperfect-consonant"] {
            border-color: #3b82f6;
        }
        .interval-btn[data-consonance="imperfect-consonant"]:hover,
        .interval-btn[data-consonance="imperfect-consonant"].active {
            border-color: #3b82f6;
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.4);
        }

        .interval-btn[data-consonance="mild-dissonant"] {
            border-color: #eab308;
        }
        .interval-btn[data-consonance="mild-dissonant"]:hover,
        .interval-btn[data-consonance="mild-dissonant"].active {
            border-color: #eab308;
            box-shadow: 0 0 8px rgba(234, 179, 8, 0.4);
        }

        .interval-btn[data-consonance="strong-dissonant"] {
            border-color: #dc2626;
        }
        .interval-btn[data-consonance="strong-dissonant"]:hover,
        .interval-btn[data-consonance="strong-dissonant"].active {
            border-color: #dc2626;
            box-shadow: 0 0 8px rgba(220, 38, 38, 0.4);
        }

        /* Agrupación de intervalos */
        .interval-group {
            display: inline-flex;
            flex-direction: column;
            gap: 8px;
            margin-right: 16px;
            margin-bottom: 12px;
        }

        .interval-group-title {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 4px;
        }

        .interval-group-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* Controles de reproducción */
        .interval-play-controls {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
            padding: 16px 0;
            border-bottom: 1px solid #333;
            margin-bottom: 16px;
        }

        .interval-play-btn {
            padding: 8px 14px;
            border-radius: 6px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            border: 2px solid #444;
            background: #1a1a1a;
            color: #999;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .interval-play-btn:hover {
            border-color: #666;
            color: #fafafa;
            background: #252525;
        }

        .interval-play-btn.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
        }

        /* Selector de dirección */
        .direction-selector {
            display: flex;
            gap: 4px;
            background: #0a0a0a;
            padding: 4px;
            border-radius: 8px;
            border: 1px solid #333;
        }

        .direction-btn {
            padding: 6px 12px;
            border-radius: 4px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            border: none;
            background: transparent;
            color: #666;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
        }

        .direction-btn:hover {
            color: #999;
        }

        .direction-btn.active {
            background: #252525;
            color: #fafafa;
        }

        /* Modo comparación */
        .comparison-mode {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            display: none;
        }

        .comparison-mode.active {
            display: block;
        }

        .comparison-display {
            display: flex;
            gap: 16px;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .comparison-item {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 14px;
            font-weight: 600;
            color: #fafafa;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 16px;
            border-radius: 6px;
            min-width: 120px;
            text-align: center;
        }

        .comparison-item.empty {
            color: #666;
            font-style: italic;
        }

        .comparison-vs {
            font-size: 12px;
            color: #93c5fd;
            font-weight: 700;
        }

        .comparison-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .comparison-btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            border: 2px solid #60a5fa;
            background: rgba(255, 255, 255, 0.1);
            color: #fafafa;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
        }

        .comparison-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #93c5fd;
        }

        .comparison-btn.exit {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.2);
        }

        .comparison-btn.exit:hover {
            background: rgba(239, 68, 68, 0.3);
            border-color: #f87171;
        }

        /* Leyenda de colores */
        .consonance-legend {
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
            padding: 12px 0;
            border-bottom: 1px solid #333;
            margin-bottom: 16px;
        }

        .consonance-legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .consonance-color-box {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            border: 2px solid;
        }

        .consonance-color-box.perfect {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.2);
        }

        .consonance-color-box.imperfect {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.2);
        }

        .consonance-color-box.mild {
            border-color: #eab308;
            background: rgba(234, 179, 8, 0.2);
        }

        .consonance-color-box.strong {
            border-color: #dc2626;
            background: rgba(220, 38, 38, 0.2);
        }

        .consonance-legend-label {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            color: #999;
            font-weight: 500;
        }

        /* Chord button - industrial with rounded */
        .chord-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 500;
            border: 1.5px solid #333;
            background: #151515;
            color: #ccc;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            min-width: 55px;
        }

        .chord-btn:hover {
            border-color: #dc2626;
            color: #fafafa;
            background: #1a1a1a;
            transform: translateY(-2px);
        }

        .chord-btn.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.3);
        }

        /* ========== REFINED MINIMAL LAYOUT SYSTEM ========== */
        /* Spacing system for breathing room */
        :root {
            --spacing-xs: 12px;
            --spacing-sm: 16px;
            --spacing-md: 24px;
            --spacing-lg: 40px;
            --spacing-xl: 64px;
            --spacing-2xl: 80px;
        }

        /* Global spacing improvements - ULTRA COMPACT */
        .gap-2 { gap: 8px !important; }
        .gap-3 { gap: 12px !important; }
        .gap-4 { gap: 16px !important; }
        .gap-6 { gap: 20px !important; }
        .gap-8 { gap: 24px !important; }

        /* Improve margins - MINIMIZED */
        .mb-4 { margin-bottom: 12px !important; }
        .mb-6 { margin-bottom: 16px !important; }
        .mt-4 { margin-top: 12px !important; }
        .my-4 { margin-top: 12px !important; margin-bottom: 12px !important; }

        /* Universal minimal container - no boxes, direct content */
        .minimal-container {
            background: none;
            border: none;
            box-shadow: none;
            padding: 0;
            margin: 0;
        }

        /* Hide all unnecessary labels across app */
        .minimal-hide-labels .info-label,
        .minimal-hide-labels .info-description {
            display: none;
        }

        /* ========== NIVEL 3: ULTRA COMPACT LAYOUT ========== */

        /* Compactar todo cuando Nivel 3 está activo */
        .level3-top-section:not(.hidden) ~ * #displayTitle {
            font-size: 20px !important;
            line-height: 1.1 !important;
            margin-bottom: 2px !important;
        }

        .level3-top-section:not(.hidden) ~ * #displaySubtitle {
            font-size: 10px !important;
            margin-top: 2px !important;
        }

        .level3-top-section {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 4px 0 4px 0;
            min-height: auto;
        }

        .level3-top-section.hidden {
            display: none;
        }

        .level3-content-row {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            gap: 48px;
            max-width: 1200px;
        }

        /* Chord Diagrams - Sin modificar tamaño */
        .level3-content-row .diagrams-container {
            display: flex;
            gap: 16px;
            padding: 0;
            margin: 0;
            background: none;
            border: none;
            box-shadow: none;
        }

        .level3-content-row .diagrams-container .mb-4 {
            margin-bottom: 0 !important;
        }

        .level3-content-row .chord-diagram {
            transform: none;
            margin: 0;
            max-width: 340px;
        }

        .level3-content-row .chord-diagram .string-row {
            height: 32px;
        }

        .level3-content-row .chord-diagram .fret-cell {
            width: 44px;
        }

        .level3-content-row .chord-diagram .fret-cell.nut-fret {
            width: 32px;
        }

        .level3-content-row .chord-diagram .finger-dot {
            width: 26px;
            height: 26px;
            font-size: 11px;
        }

        .level3-content-row .chord-diagram .open-indicator,
        .level3-content-row .chord-diagram .muted-indicator {
            width: 18px;
            height: 18px;
            font-size: 11px;
        }

        .level3-content-row .chord-diagram .chord-symbol {
            font-size: 32px;
        }

        .level3-content-row .chord-diagram .string-label-inline {
            font-size: 11px;
            width: 16px;
        }

        /* Panel T-SD-D - Sin modificar tamaño */
        .level3-harmonic-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0;
            background: none;
            border: none;
            gap: 8px;
        }

        /* Remove all boxes from harmonic panel - EXCEPT for level 2 scale info */
        .level3-harmonic-panel > .info-section,
        .level3-harmonic-panel > .info-section.accent {
            background: none !important;
            border: none !important;
            box-shadow: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }

        /* Restore styling for scale info boxes in level 2 */
        .level3-harmonic-panel .scale-info-box {
            background: none !important;
            border: none !important;
            border-radius: 0 !important;
            padding: 0 !important;
            margin-bottom: 0 !important;
        }

        .level3-harmonic-panel .scale-info-box .info-section.accent {
            background: rgba(220, 38, 38, 0.1) !important;
            border-color: #dc2626 !important;
        }

        /* Hide labels outside scale-info-box in level 3 panel */
        .level3-harmonic-panel .info-label { display: none; }
        .level3-harmonic-panel .info-description { display: none; }

        /* info-value overrides inside level3 panel */
        .level3-harmonic-panel .info-value {
            color: rgba(255, 255, 255, 0.65);
            font-size: 12px;
            font-weight: 400;
            text-align: center;
            margin: 6px 0 0 0;
            max-width: 260px;
            line-height: 1.3;
            letter-spacing: 0.1px;
        }

        .level3-harmonic-panel .scale-info-box .info-value {
            text-align: left !important;
            max-width: none !important;
            font-size: 14px !important;
            color: #e0e0e0 !important;
            margin: 0 !important;
        }

        /* Responsive adjustments for scale info sections */
        @media (max-width: 768px) {
            .level3-harmonic-panel .scale-info-box .info-section {
                margin-bottom: 12px !important;
            }

            .genre-tag {
                font-size: 9px;
                padding: 5px 12px;
            }
        }

        /* Staggered animation for info sections */
        .level3-harmonic-panel .scale-info-box .info-section:nth-child(1) {
            animation: fadeInUp 0.5s ease-out 0.1s both;
        }

        .level3-harmonic-panel .scale-info-box .info-section:nth-child(2) {
            animation: fadeInUp 0.5s ease-out 0.2s both;
        }

        .level3-harmonic-panel .scale-info-box .info-section:nth-child(3) {
            animation: fadeInUp 0.5s ease-out 0.3s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* STYLES FOR infoPanelOtherLevels (Level 2 and others) */
        /* Shared styles for scale-info-box info-section in both panel contexts */
        .level3-harmonic-panel .scale-info-box .info-section,
        #infoPanelOtherLevels .scale-info-box .info-section {
            background: linear-gradient(135deg, rgba(20, 20, 20, 0.8) 0%, rgba(30, 30, 30, 0.6) 100%);
            border: 1px solid #444;
            border-left: 3px solid #dc2626;
            border-radius: 8px;
            padding: 16px;
            margin: 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .level3-harmonic-panel .scale-info-box .info-section::before,
        #infoPanelOtherLevels .scale-info-box .info-section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 40px;
            height: 40px;
            background: radial-gradient(circle at center, rgba(220, 38, 38, 0.15), transparent 70%);
            pointer-events: none;
        }

        .level3-harmonic-panel .scale-info-box .info-section:hover,
        #infoPanelOtherLevels .scale-info-box .info-section:hover {
            border-left-width: 4px;
            transform: translateX(2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .level3-harmonic-panel .scale-info-box .info-label,
        #infoPanelOtherLevels .scale-info-box .info-label {
            display: block;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #dc2626;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 2px solid rgba(220, 38, 38, 0.3);
            position: relative;
        }

        .level3-harmonic-panel .scale-info-box .info-label::after,
        #infoPanelOtherLevels .scale-info-box .info-label::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 40px;
            height: 2px;
            background: #dc2626;
            box-shadow: 0 0 8px rgba(220, 38, 38, 0.6);
        }

        .level3-harmonic-panel .scale-info-box .info-description,
        #infoPanelOtherLevels .scale-info-box .info-description {
            display: block;
            color: #e8e8e8;
            font-size: 13px;
            line-height: 1.7;
            margin: 0;
            font-weight: 400;
            letter-spacing: 0.2px;
        }

        .level3-harmonic-panel .scale-info-box .info-description::first-letter,
        #infoPanelOtherLevels .scale-info-box .info-description::first-letter {
            font-size: 1.1em;
            font-weight: 600;
            color: #ff6b6b;
        }

        .level3-harmonic-panel .scale-info-box .grid,
        #infoPanelOtherLevels .scale-info-box .grid { display: grid; }

        .level3-harmonic-panel .scale-info-box .genre-tag,
        #infoPanelOtherLevels .scale-info-box .genre-tag {
            display: inline-block;
            margin: 4px;
        }

        .level3-harmonic-panel .scale-info-box .info-section:nth-child(1),
        #infoPanelOtherLevels .scale-info-box .info-section:nth-child(1) {
            animation: fadeInUp 0.5s ease-out 0.1s both;
        }

        .level3-harmonic-panel .scale-info-box .info-section:nth-child(2),
        #infoPanelOtherLevels .scale-info-box .info-section:nth-child(2) {
            animation: fadeInUp 0.5s ease-out 0.2s both;
        }

        .level3-harmonic-panel .scale-info-box .info-section:nth-child(3),
        #infoPanelOtherLevels .scale-info-box .info-section:nth-child(3) {
            animation: fadeInUp 0.5s ease-out 0.3s both;
        }

        /* T-SD-D Diagram */
        .level3-harmonic-panel .harmonic-function-diagram {
            width: 270px;
            margin: 0;
        }

        .level3-harmonic-panel .harmonic-function-diagram svg {
            width: 100%;
            height: auto;
        }

        /* T-SD-D Diagram general */
        .harmonic-function-diagram {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
        }

        .harmonic-function-diagram svg {
            width: 100%;
            height: auto;
        }

        .function-node {
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .function-node:hover {
            filter: brightness(1.2);
        }

        .function-node.active {
            filter: brightness(1.4) saturate(1.15);
        }

        /* Responsive scaling */
        @media (max-width: 1280px) {
            .level3-content-row {
                flex-direction: column;
                gap: 24px;
                align-items: center;
            }

            .level3-top-section {
                padding: 6px 0 10px 0;
            }
        }

        @media (max-width: 768px) {
            .level3-top-section {
                padding: 4px 0 8px 0;
            }
        }

        /* ========== NIVEL 4: ACORDES EXTENDIDOS TOP SECTION ========== */

        .level4-top-section {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 4px 0 4px 0;
        }

        .level4-top-section.hidden {
            display: none;
        }

        .level4-content-row {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            gap: 32px;
            max-width: 1200px;
            width: 100%;
        }

        /* Chord diagram slot — same compact sizing as nivel 3 */
        .level4-diagram-slot {
            flex-shrink: 0;
            display: flex;
            align-items: flex-start;
        }

        .level4-diagram-slot .chord-diagram .string-row { height: 32px; }
        .level4-diagram-slot .chord-diagram .fret-cell { width: 44px; }
        .level4-diagram-slot .chord-diagram .fret-cell.nut-fret { width: 32px; }
        .level4-diagram-slot .chord-diagram .finger-dot { width: 26px; height: 26px; font-size: 11px; }
        .level4-diagram-slot .chord-diagram .open-indicator,
        .level4-diagram-slot .chord-diagram .muted-indicator { width: 18px; height: 18px; font-size: 11px; }
        .level4-diagram-slot .chord-diagram .chord-symbol { font-size: 32px; }
        .level4-diagram-slot .chord-diagram .string-label-inline { font-size: 11px; width: 16px; }

        /* Intro/explanation slot — fills remaining space */
        .level4-intro-slot {
            flex: 1;
            min-width: 0;
            max-width: 600px;
            display: flex;
            align-items: flex-start;
            overflow-y: auto;
            max-height: 220px;
        }

        .level4-intro-slot > div {
            width: 100%;
        }

        #ext4-chord-detail {
            border-top: 1px solid #2a2a2a;
            padding-top: 8px;
            margin-top: 6px;
        }

        .level4-intro-slot .scale-info-box {
            background: none !important;
            border: none !important;
            padding: 0 !important;
        }

        @media (max-width: 1280px) {
            .level4-content-row {
                flex-direction: column;
                gap: 16px;
                align-items: center;
            }
        }

        /* ========== SCALE LEVEL 2 ENHANCEMENTS ========== */

        /* Scale play controls */
        .scale-play-controls {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #333;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .scale-play-btn {
            padding: 10px 16px;
            border-radius: 8px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            border: 2px solid #333;
            background: #151515;
            color: #ccc;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
        }

        .scale-play-btn:hover {
            border-color: #dc2626;
            color: #fafafa;
            background: #1a1a1a;
        }

        .scale-play-btn.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.3);
        }

        .speed-selector {
            display: flex;
            gap: 4px;
            background: #0a0a0a;
            padding: 4px;
            border-radius: 8px;
        }

        .speed-btn {
            padding: 8px 14px;
            border: 1px solid transparent;
            background: transparent;
            color: #666;
            cursor: pointer;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            border-radius: 6px;
            transition: all 0.15s ease;
        }

        .speed-btn:hover {
            color: #ccc;
            background: rgba(255, 255, 255, 0.05);
        }

        .speed-btn.active {
            color: #fafafa;
            background: #dc2626;
            border-color: #dc2626;
        }

        /* Comparison mode */
        .comparison-mode-scales {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            display: none;
        }

        .comparison-mode-scales.active {
            display: block;
        }

        .comparison-display {
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .comparison-item {
            padding: 12px 20px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #3b82f6;
            border-radius: 8px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            color: #fafafa;
            min-width: 150px;
            text-align: center;
        }

        .comparison-item.empty {
            color: #93c5fd;
            border-style: dashed;
        }

        .comparison-vs {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 14px;
            font-weight: 700;
            color: #fafafa;
        }

        .comparison-split-view {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        @media (max-width: 768px) {
            .comparison-split-view {
                grid-template-columns: 1fr;
            }
        }

        .comparison-fretboard-mini {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 12px;
        }

        .comparison-scale-label {
            font-size: 14px;
            font-weight: 600;
            color: #fafafa;
            margin-bottom: 8px;
            font-family: 'IBM Plex Mono', monospace;
        }

        .comparison-controls {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .comparison-btn {
            padding: 10px 18px;
            border-radius: 8px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            border: 2px solid #3b82f6;
            background: rgba(59, 130, 246, 0.2);
            color: #fafafa;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
        }

        .comparison-btn:hover {
            background: rgba(59, 130, 246, 0.3);
            transform: translateY(-2px);
        }

        .comparison-btn.exit {
            border-color: #dc2626;
            background: rgba(220, 38, 38, 0.2);
        }

        .comparison-btn.exit:hover {
            background: rgba(220, 38, 38, 0.3);
        }

        /* Pentatonic tabs */
        .penta-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            border-bottom: 2px solid #333;
            flex-wrap: wrap;
        }

        .penta-tab-btn {
            padding: 10px 20px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: #666;
            cursor: pointer;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            transition: all 0.15s ease;
        }

        .penta-tab-btn:hover {
            color: #ccc;
        }

        .penta-tab-btn.active {
            color: #fafafa;
            border-bottom-color: #dc2626;
        }

        .penta-tab-content {
            display: none;
        }

        .penta-tab-content.active {
            display: block;
        }

        /* All boxes simultaneous view */
        .all-boxes-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        @media (max-width: 1024px) {
            .all-boxes-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 640px) {
            .all-boxes-container {
                grid-template-columns: 1fr;
            }
        }

        .box-diagram-mini {
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .box-diagram-mini:hover {
            border-color: #666;
        }

        .box-diagram-mini.active {
            border-color: #dc2626;
            background: rgba(220, 38, 38, 0.1);
        }

        .box-diagram-title {
            font-size: 11px;
            color: #999;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
            font-family: 'IBM Plex Mono', monospace;
        }

        .box-diagram-ascii {
            font-family: 'Courier New', monospace;
            font-size: 10px;
            color: #ccc;
            line-height: 1.4;
            white-space: pre;
        }

        /* Genre tags for advanced scales */
        .genre-tag {
            display: inline-block;
            padding: 6px 14px;
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.25) 0%, rgba(220, 38, 38, 0.15) 100%);
            border: 1.5px solid #dc2626;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: #ff6b6b;
            margin-right: 8px;
            margin-bottom: 8px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .genre-tag::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15), transparent);
            transition: left 0.5s;
        }

        .genre-tag:hover {
            transform: translateY(-2px);
            border-color: #ff4444;
            box-shadow: 0 4px 16px rgba(220, 38, 38, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            color: #ff8888;
        }

        .genre-tag:hover::before {
            left: 100%;
        }

        .info-section {
            margin-bottom: 8px;
        }

        .info-label {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .info-value {
            font-size: 12px;
            color: #ccc;
        }

        .info-description {
            font-size: 12px;
            color: #999;
            line-height: 1.5;
        }

        /* Licks container */
        .lick-item {
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .lick-name {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            color: #fafafa;
            margin-bottom: 8px;
        }

        .lick-tabs {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            color: #ccc;
            line-height: 1.3;
            white-space: pre;
            background: #0a0a0a;
            padding: 12px;
            border-radius: 6px;
            overflow-x: auto;
            margin-bottom: 8px;
        }

        .lick-description {
            font-size: 11px;
            color: #999;
            font-style: italic;
        }

        .scale-cat-btn {
            padding: 10px 16px;
            border-radius: 8px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            border: 2px solid #333;
            background: #151515;
            color: #ccc;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
        }

        .scale-cat-btn:hover {
            border-color: #dc2626;
            color: #fafafa;
            background: #1a1a1a;
        }

        .scale-cat-btn.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.3);
        }

        .penta-type-btn,
        .box-btn {
            padding: 10px 16px;
            border-radius: 8px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            border: 2px solid #333;
            background: #151515;
            color: #ccc;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .penta-type-btn:hover,
        .box-btn:hover {
            border-color: #dc2626;
            color: #fafafa;
            background: #1a1a1a;
        }

        .penta-type-btn.active,
        .box-btn.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.3);
        }

        .chord-btn .roman {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 22px;
            font-weight: 400;
            display: block;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }

        .chord-btn .name {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 11px;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Mode button - industrial with rounded */
        .mode-btn {
            padding: 14px 18px;
            border-radius: 10px;
            border: 2px solid #333;
            border-left: 4px solid #444;
            background: #151515;
            color: #ccc;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: left;
        }

        .mode-btn:hover {
            border-color: #d4a574;
            border-left-color: #d4a574;
            background: #1a1a1a;
            transform: translateX(4px);
        }

        .mode-btn.active {
            border-color: #d4a574;
            border-left-color: #d4a574;
            background: rgba(212, 165, 116, 0.1);
        }

        .mode-btn .mode-name {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 20px;
            color: #d4a574;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }

        .mode-btn .mode-degree {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Animations - sharper, more industrial */
        @keyframes pulse-glow {
            0%, 100% {
                box-shadow:
                    0 0 0 2px #0a0a0a,
                    0 0 0 4px #dc2626,
                    0 4px 20px rgba(220, 38, 38, 0.5);
            }
            50% {
                box-shadow:
                    0 0 0 2px #0a0a0a,
                    0 0 0 6px #dc2626,
                    0 4px 30px rgba(220, 38, 38, 0.7);
            }
        }

        .note-bubble.tonic.pulse {
            animation: pulse-glow 1.5s ease-in-out infinite;
        }

        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fade-in-up 0.3s ease-out forwards;
        }

        @keyframes slide-in-left {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-in-left {
            animation: slide-in-left 0.25s ease-out forwards;
        }

        /* Theory text - improved readability */
        .theory-text {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            color: #bbb;
            font-weight: 400;
        }

        .theory-text strong {
            color: #fafafa;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .theory-text em {
            color: #dc2626;
            font-style: normal;
            font-weight: 600;
        }

        .formula-box {
            background: #121212;
            border: 2px solid #333;
            border-left: 4px solid #dc2626;
            border-radius: 10px;
            padding: 16px 20px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 16px;
            font-weight: 600;
            color: #fafafa;
            letter-spacing: 3px;
            text-align: center;
            margin: 16px 0;
        }

        /* ============================================
           JAM SESSION - STUDIO VINYL MODERNIST
           ============================================ */

        #jamSessionFullLayout {
            display: none;
            width: 100%;
            min-height: 100vh;
            background: var(--vinyl-black);
        }

        #jamSessionFullLayout.active {
            display: block !important;
        }

        .jam-session-layout {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 0;
            height: 100vh;
            overflow: hidden;
        }

        /* SIDEBAR DE TRACKS */
        .jam-sidebar {
            background: var(--studio-gray);
            border-right: 1px solid var(--steel);
            display: flex;
            flex-direction: column;
            position: sticky;
            top: 0;
            height: 100vh;
        }

        .jam-sidebar-header {
            padding: 16px;
            border-bottom: 1px solid var(--steel);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-label {
            font-family: 'DM Sans', sans-serif;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0.1em;
            color: var(--chrome);
        }

        .sidebar-count {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: var(--chrome);
            background: rgba(255,255,255,0.05);
            padding: 2px 6px;
            border-radius: 3px;
        }

        .jam-tracklist {
            overflow-y: auto;
            padding: 8px;
            flex: 1;
        }

        .jam-track-item {
            width: 100%;
            background: transparent;
            border: 1px solid transparent;
            padding: 12px 10px;
            text-align: left;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            flex-direction: column;
            gap: 4px;
            border-radius: 4px;
            margin-bottom: 4px;
        }

        .jam-track-item:hover {
            background: rgba(255,255,255,0.03);
            border-color: var(--steel);
        }

        .jam-track-item.active {
            background: rgba(220, 38, 38, 0.15);
            border-color: var(--tape-red);
            box-shadow: inset 2px 0 0 var(--tape-red);
        }

        .jam-track-item:active {
            animation: pulse 0.2s ease;
        }

        .track-name {
            font-family: 'DM Sans', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: var(--paper);
            line-height: 1.3;
        }

        .jam-track-item.active .track-name {
            color: var(--tape-red);
        }

        .track-bpm {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: var(--chrome);
            letter-spacing: 0.05em;
        }

        .track-bpm::after {
            content: ' BPM';
            opacity: 0.5;
        }

        /* ÁREA PRINCIPAL */
        .jam-main-area {
            padding: 20px 24px;
            overflow-y: auto;
        }

        /* KEY INFO BAR */
        .jam-keyinfo-bar {
            background: var(--studio-gray);
            border: 1px solid var(--steel);
            border-radius: 8px;
            padding: 20px 24px;
            display: grid;
            grid-template-columns: 280px 1fr 320px;
            gap: 32px;
            align-items: center;
            margin-bottom: 20px;
        }

        .key-display {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .key-label {
            font-family: 'DM Sans', sans-serif;
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.15em;
            color: var(--chrome);
        }

        .key-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--key-highlight);
            line-height: 1;
            text-transform: uppercase;
            letter-spacing: -0.02em;
            transition: color 0.3s ease, transform 0.2s ease;
        }

        .key-value.updating {
            transform: scale(1.05);
        }

        /* PROGRESSION DISPLAY */
        .progression-display {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding-left: 32px;
            border-left: 1px solid var(--steel);
        }

        .progression-label {
            font-family: 'DM Sans', sans-serif;
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.15em;
            color: var(--chrome);
        }

        .progression-chords {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .prog-chord {
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 600;
            color: var(--paper);
            background: rgba(255,255,255,0.05);
            padding: 4px 10px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .prog-chord.active {
            background: var(--chord-active);
            color: var(--vinyl-black);
            transform: scale(1.1);
        }

        .prog-separator {
            font-family: 'JetBrains Mono', monospace;
            color: var(--chrome);
            opacity: 0.4;
        }

        /* CONTROLS */
        .jam-controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding-left: 32px;
            border-left: 1px solid var(--steel);
        }

        .control-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ctrl-btn {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            border: 1.5px solid var(--steel);
            background: rgba(255,255,255,0.05);
            color: var(--paper);
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .ctrl-btn:hover:not(:disabled) {
            background: rgba(255,255,255,0.1);
            border-color: var(--paper);
        }

        .ctrl-play {
            background: var(--vumeter-green);
            border-color: var(--vumeter-green);
        }

        .ctrl-play:hover:not(:disabled) {
            background: #14b88c;
            box-shadow: 0 0 12px rgba(16, 185, 129, 0.4);
        }

        .ctrl-play:not(:disabled) {
            animation: playGlow 2s ease-in-out infinite;
        }

        .ctrl-stop {
            background: var(--tape-red);
            border-color: var(--tape-red);
        }

        .ctrl-stop:hover:not(:disabled) {
            background: #c81e1e;
        }

        .ctrl-stop:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .ctrl-select {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            background: rgba(255,255,255,0.05);
            color: var(--paper);
            border: 1px solid var(--steel);
            border-radius: 4px;
            padding: 8px 10px;
            cursor: pointer;
        }

        .ctrl-select option {
            background: var(--vinyl-black);
            color: var(--paper);
        }

        .ctrl-slider {
            flex: 1;
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            accent-color: var(--tape-red);
        }

        .bpm-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 600;
            color: var(--tape-red) !important;
            min-width: 40px;
            text-align: center;
            display: inline-block !important;
            opacity: 1 !important;
            visibility: visible !important;
        }

        .ctrl-toggle {
            display: flex;
            align-items: center;
            gap: 6px;
            font-family: 'DM Sans', sans-serif;
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.1em;
            color: var(--chrome);
            cursor: pointer;
        }

        .ctrl-toggle input[type="checkbox"] {
            width: 14px;
            height: 14px;
            accent-color: var(--vumeter-green);
        }

        /* LIVE PROGRESS PANEL */
        .jam-live-progress {
            background: rgba(10, 10, 10, 0.95);
            border: 1px solid var(--vumeter-green);
            border-radius: 8px;
            padding: 20px 24px;
            margin-bottom: 16px;
            display: none;
            backdrop-filter: blur(10px);
        }

        .jam-live-progress.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .live-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .live-label {
            font-family: 'DM Sans', sans-serif;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.15em;
            color: var(--vumeter-green);
            background: rgba(16, 185, 129, 0.15);
            padding: 4px 10px;
            border-radius: 3px;
        }

        .live-stats {
            display: flex;
            gap: 16px;
        }

        .live-stat {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--chrome);
        }

        .live-stat span {
            color: var(--paper);
            font-weight: 600;
            margin-left: 4px;
        }

        .live-chord {
            text-align: center;
            margin-bottom: 20px;
        }

        .live-chord-name {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 56px;
            font-weight: 700;
            color: var(--chord-active);
            line-height: 1;
            margin-bottom: 8px;
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        .live-chord-function {
            font-family: 'DM Sans', sans-serif;
            font-size: 14px;
            color: var(--chrome);
        }

        .live-beats {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .beat-pip {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.1s ease;
        }

        .beat-pip.active {
            background: var(--vumeter-green);
            box-shadow: 0 0 12px rgba(16, 185, 129, 0.6);
            transform: scale(1.3);
            animation: beatPulse 0.15s ease;
        }

        .live-progress-track {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        .live-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--vumeter-green), var(--chord-active));
            width: 0%;
            transition: width 0.1s linear;
        }

        /* TIP */
        .jam-tip {
            font-family: 'DM Sans', sans-serif;
            font-size: 11px;
            color: var(--chrome);
            background: rgba(220, 38, 38, 0.08);
            border-left: 2px solid var(--tape-red);
            padding: 12px 16px;
            border-radius: 4px;
            margin-top: 16px;
        }

        .jam-tip strong {
            color: var(--tape-red);
            font-weight: 600;
        }

        /* Asegurar que el diapasón en Jam Session se vea correctamente */
        #jamFretboard {
            min-height: 400px;
        }

        #jamFretboard .string {
            display: flex;
            gap: 0;
            margin-bottom: 16px;
            align-items: center;
        }

        #jamFretboard .fret {
            flex: 1;
            min-width: 60px;
            height: 60px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 2px solid rgba(255, 255, 255, 0.1);
        }

        #jamFretboard .fret:first-child {
            flex: 0.6;
            min-width: 40px;
        }

        #jamFretboard .note-bubble {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        /* Burbujas visibles */
        #jamFretboard .note-bubble.visible {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        #jamFretboard .note-bubble.tonic {
            background: var(--tape-red);
            color: var(--vinyl-black);
        }

        #jamFretboard .note-bubble.interval {
            background: rgba(255, 255, 255, 0.9);
            color: var(--vinyl-black);
        }

        #jamFretboard .note-bubble.pulse {
            animation: fretPulse 1.5s ease-in-out infinite;
        }

        @keyframes fretPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 rgba(220, 38, 38, 0.4); }
            50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(220, 38, 38, 0.6); }
        }

        /* FRETBOARD EN JAM SESSION */
        .jam-fretboard-container {
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: visible;
            border: 1px solid var(--steel);
            background: linear-gradient(180deg, #1a1412 0%, #0d0a08 100%);
            padding: 16px;
        }

        .jam-fretboard-container .fretboard-container {
            background: transparent;
        }

        /* Asegurar que el diapasón del Jam Session se vea correctamente */
        #jamFretboard .string {
            display: flex;
            margin-bottom: 12px;
        }

        #jamFretboard .fret {
            flex: 1;
            position: relative;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ANIMATIONS */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(0.98); }
        }

        @keyframes playGlow {
            0%, 100% { box-shadow: 0 0 8px rgba(16, 185, 129, 0.3); }
            50% { box-shadow: 0 0 16px rgba(16, 185, 129, 0.6); }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes beatPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.5); }
            100% { transform: scale(1.3); }
        }

        /* Header glow effect - industrial */
        .header-glow {
            position: relative;
        }

        .header-glow::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, #dc2626 50%, transparent 100%);
            opacity: 0.6;
        }

        /* String labels */
        .string-label {
            width: 32px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            color: #666;
            text-align: center;
        }

        /* Progression button - industrial with rounded */
        .progression-btn {
            padding: 12px 16px;
            border-radius: 10px;
            border: 2px solid #333;
            background: #151515;
            color: #ccc;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: left;
        }

        .progression-btn:hover {
            border-color: #fafafa;
            background: #1a1a1a;
            color: #fafafa;
        }

        .progression-btn.active {
            border-color: #fafafa;
            background: #fafafa;
            color: #0a0a0a;
        }

        /* Circle of fifths - industrial with rounded */
        .circle-note {
            position: absolute;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.15s ease;
            background: #252525;
            color: #ccc;
            border: 2px solid #333;
        }

        .circle-note:hover {
            transform: scale(1.15);
            border-color: #dc2626;
            color: #fafafa;
        }

        .circle-note.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
        }

        .circle-note.minor {
            font-size: 10px;
            width: 30px;
            height: 30px;
            background: #1a1a1a;
            color: #888;
        }

        .circle-note.minor.active {
            background: #fafafa;
            color: #0a0a0a;
            border-color: #fafafa;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }

        /* Circle of Fifths — relationship highlights */
        .circle-note.highlight-dominant {
            background: #1e40af !important;
            border-color: #3b82f6 !important;
            color: #fff !important;
            box-shadow: 0 0 12px rgba(59,130,246,0.6) !important;
        }
        .circle-note.highlight-subdominant {
            background: #14532d !important;
            border-color: #22c55e !important;
            color: #fff !important;
            box-shadow: 0 0 12px rgba(34,197,94,0.6) !important;
        }
        .circle-note.highlight-relative {
            background: #374151 !important;
            border-color: #9ca3af !important;
            color: #e5e7eb !important;
        }

        /* Tour Sonoro pulse */
        @keyframes circle-pulse {
            0%   { box-shadow: 0 0 0 0   rgba(220,38,38,0.7); }
            50%  { box-shadow: 0 0 0 8px rgba(220,38,38,0);   }
            100% { box-shadow: 0 0 0 0   rgba(220,38,38,0);   }
        }
        .circle-note.tour-active {
            background: #dc2626 !important;
            border-color: #ef4444 !important;
            color: #fff !important;
            animation: circle-pulse 1s ease-in-out infinite !important;
        }

        /* Circle view / tour buttons */
        .circle-view-btn {
            padding: 4px 12px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            color: #888;
            font-size: 12px;
            font-family: 'IBM Plex Mono', monospace;
            letter-spacing: 0.03em;
            cursor: pointer;
            transition: all 0.2s;
        }
        .circle-view-btn.active {
            background: #1e0808;
            border-color: #dc2626;
            color: #fafafa;
        }
        .circle-view-btn:hover:not(.active) {
            border-color: #666;
            color: #ddd;
            background: #222;
        }

        /* Circle controls row */
        .circle-controls-row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 8px;
            border-bottom: 1px solid #1e1e1e;
            margin-bottom: 6px;
            padding-bottom: 6px;
        }

        /* Key signature staff */
        .key-signature-staff {
            background: #111;
            border: 1px solid #2a2a2a;
            border-radius: 8px;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Circle panel tabs */
        .circle-panel-tab {
            padding: 7px 18px;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            color: #666;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .circle-panel-tab.active {
            color: #fafafa;
            border-bottom-color: #dc2626;
        }
        .circle-tab-content { display: none; }
        .circle-tab-content.active { display: block; }

        /* Modulation cards */
        .modulation-card {
            background: #111;
            border: 1px solid #222;
            border-radius: 6px;
            padding: 7px 10px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        .modulation-card .mod-title { font-size: 12px; font-weight: 600; color: #fafafa; }
        .modulation-card .mod-desc  { font-size: 10px; color: #666; }
        .modulation-card .mod-prog  { font-family: 'IBM Plex Mono', monospace; font-size: 10px; color: #dc2626; }
        .modulation-card .mod-stars { font-size: 11px; color: #f59e0b; }

        /* Blue note special highlight */
        .note-bubble.blue-note {
            background: #d4a574;
            color: #0a0a0a;
            box-shadow:
                0 0 0 2px #0a0a0a,
                0 0 0 4px #d4a574,
                0 4px 15px rgba(212, 165, 116, 0.5);
        }

        /* Chord highlight for harmonization */
        .note-bubble.chord-highlight {
            box-shadow:
                0 0 0 3px #0a0a0a,
                0 0 0 6px #d4a574,
                0 4px 20px rgba(212, 165, 116, 0.6);
            transform: scale(1.15);
            z-index: 10;
        }

        /* Progression info panel - industrial with rounded */
        .progression-info {
            background: #121212;
            border: 2px solid #252525;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .chord-in-progression {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 56px;
            height: 56px;
            border-radius: 12px;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 20px;
            font-weight: 400;
            letter-spacing: 1px;
            transition: all 0.2s ease;
            border: 2px solid #333;
        }

        .chord-in-progression.current {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(220, 38, 38, 0.5);
        }

        .chord-in-progression:not(.current) {
            background: #1a1a1a;
            color: #888;
        }

        /* Chord Diagram Component - HORIZONTAL like fretboard */
        .chord-diagram {
            background: transparent;
            border-radius: 0;
            border: none;
            padding: 8px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            box-shadow: none;
            width: 100%;
            max-width: 280px;
            margin: 0 auto;
        }

        .chord-diagram::before {
            content: none;
        }

        .chord-diagram-grid {
            display: flex;
            flex-direction: column;
            position: relative;
            padding-left: 0;
        }

        .chord-diagram .nut {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 8px;
            background: linear-gradient(90deg, #f0ead6 0%, #c4b89a 100%);
            border-radius: 2px;
            box-shadow: 4px 0 10px rgba(0,0,0,0.4);
            z-index: 5;
        }

        .chord-diagram .string-row {
            display: flex;
            align-items: center;
            height: 32px;
            position: relative;
            border-bottom: 1px solid rgba(255, 255, 255, 0.02);
            padding-left: 24px;
        }

        .chord-diagram .string-row::before {
            content: '';
            position: absolute;
            left: 24px;
            right: 0;
            top: 50%;
            height: 2px;
            background: linear-gradient(90deg,
                rgba(200, 180, 160, 0.2) 0%,
                rgba(220, 200, 180, 0.7) 15%,
                rgba(200, 180, 160, 0.5) 50%,
                rgba(180, 160, 140, 0.3) 100%
            );
            transform: translateY(-50%);
            box-shadow: 0 1px 3px rgba(0,0,0,0.6);
        }

        /* Chord diagram strings: thin at top (high e), thick at bottom (low E) - matching main fretboard */
        .chord-diagram .string-row:nth-child(1)::before { height: 3.5px; opacity: 0.6; background: linear-gradient(90deg, rgba(150, 140, 130, 0.2) 0%, rgba(160, 150, 140, 0.45) 15%, rgba(140, 130, 120, 0.28) 50%, rgba(130, 120, 110, 0.15) 100%); }
        .chord-diagram .string-row:nth-child(2)::before { height: 3px; opacity: 0.65; background: linear-gradient(90deg, rgba(160, 150, 140, 0.2) 0%, rgba(170, 160, 150, 0.55) 15%, rgba(150, 140, 130, 0.35) 50%, rgba(140, 130, 120, 0.18) 100%); }
        .chord-diagram .string-row:nth-child(3)::before { height: 2.5px; opacity: 0.7; background: linear-gradient(90deg, rgba(180, 165, 150, 0.2) 0%, rgba(190, 175, 160, 0.65) 15%, rgba(170, 155, 140, 0.45) 50%, rgba(160, 145, 130, 0.25) 100%); }
        .chord-diagram .string-row:nth-child(4)::before { height: 2px; opacity: 0.75; }
        .chord-diagram .string-row:nth-child(5)::before { height: 1.5px; opacity: 0.8; }
        .chord-diagram .string-row:nth-child(6)::before { height: 1px; opacity: 0.85; }

        .chord-diagram .fret-cell {
            position: relative;
            width: 45px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 3px solid #555;
            box-shadow: inset -2px 0 6px rgba(0,0,0,0.4), inset 2px 0 4px rgba(255,255,255,0.02);
        }

        .chord-diagram .fret-cell.nut-fret {
            width: 32px;
            background: linear-gradient(90deg, #f0ead6 0%, #d8cdb8 50%, #c4b89a 100%);
            border-right: 5px solid #1a1a1a;
            box-shadow: inset -4px 0 10px rgba(0,0,0,0.5), 4px 0 12px rgba(0,0,0,0.4);
        }

        .chord-diagram .finger-dot {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            font-weight: 700;
            z-index: 10;
            position: relative;
            text-transform: uppercase;
        }

        .chord-diagram .finger-dot.root {
            background: #dc2626;
            color: #fafafa;
            box-shadow:
                0 0 0 2px #0a0a0a,
                0 0 15px rgba(220, 38, 38, 0.6),
                0 3px 10px rgba(0,0,0,0.4);
        }

        .chord-diagram .finger-dot.note {
            background: #fafafa;
            color: #0a0a0a;
            box-shadow:
                0 0 0 2px #0a0a0a,
                0 3px 10px rgba(0,0,0,0.4);
        }

        .chord-diagram .open-indicator {
            position: absolute;
            left: 0;
            width: 18px;
            height: 18px;
            border: 2px solid #fafafa;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #fafafa;
            font-weight: 600;
        }

        .chord-diagram .muted-indicator {
            position: absolute;
            left: 0;
            font-size: 16px;
            color: #666;
            font-weight: bold;
        }

        .chord-diagram .barre-line {
            position: absolute;
            width: 20px;
            background: #fafafa;
            border-radius: 10px;
            z-index: 5;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
            left: 50%;
            transform: translateX(-50%);
        }

        .chord-diagram .fret-numbers {
            display: flex;
            padding-left: 24px;
            margin-top: 6px;
        }

        .chord-diagram .fret-num {
            width: 45px;
            text-align: center;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px;
            font-weight: 600;
            color: #525252;
        }

        .chord-diagram .string-label-inline {
            position: absolute;
            left: -30px;
            width: 22px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px;
            font-weight: 600;
            color: #737373;
            letter-spacing: 0;
        }

        /* Chord name display - industrial */
        .chord-name-display {
            text-align: center;
            margin-bottom: 8px;
            width: 100%;
        }

        .chord-name-display .chord-symbol {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 32px;
            color: #fafafa;
            letter-spacing: 1px;
        }

        .chord-name-display .chord-type {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: #888;
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* Position indicator - industrial with rounded */
        .position-indicator {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            background: #1a1a1a;
            border: 2px solid #333;
            border-left: 4px solid #dc2626;
            border-radius: 20px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            color: #fafafa;
            margin: 10px 0;
        }

        /* Fretboard zone highlight */
        .fret.in-zone {
            background: rgba(220, 38, 38, 0.06);
        }

        .fret.zone-start {
            border-left: 3px solid rgba(220, 38, 38, 0.6);
        }

        .fret.zone-end {
            border-right: 3px solid rgba(220, 38, 38, 0.6);
        }

        /* Box/Position selector - industrial with rounded */
        .box-selector {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin: 16px 0;
        }

        .box-btn {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            border: 2px solid #333;
            background: #1a1a1a;
            color: #888;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 20px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .box-btn:hover {
            border-color: #666;
            color: #fafafa;
        }

        .box-btn.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.4);
        }

        /* Diagrams container */
        .diagrams-container {
            display: flex;
            flex-direction: row;
            gap: 16px;
            justify-content: center;
            align-items: flex-start;
            flex-wrap: wrap;
            max-width: 100%;
            overflow-x: auto;
            padding: 8px;
        }

        .diagrams-container.scrollable-horizontal {
            flex-wrap: nowrap;
            overflow-x: auto;
            overflow-y: hidden;
            padding-bottom: 12px;
        }

        .diagrams-container.scrollable-horizontal::-webkit-scrollbar {
            height: 8px;
        }

        .diagrams-container.scrollable-horizontal::-webkit-scrollbar-thumb {
            background: linear-gradient(90deg, #dc2626 0%, #991b1b 100%);
            border-radius: 4px;
        }

        .chord-diagram.compact {
            min-width: 140px;
            max-width: 160px;
            padding: 12px;
        }

        .chord-diagram.compact .chord-name-display .chord-symbol {
            font-size: 28px;
        }

        .chord-diagram.compact .fret-cell {
            width: 40px;
        }

        .chord-diagram.compact .finger-dot {
            width: 22px;
            height: 22px;
            font-size: 9px;
        }

        .chord-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }

        .chord-wrapper.active-chord {
            transform: scale(1.05);
        }

        /* Interval label on fretboard */
        .note-bubble .interval-label {
            font-size: 10px;
            font-weight: 600;
            opacity: 0.9;
        }

        /* Dimmed notes (outside current zone) */
        .note-bubble.dimmed {
            opacity: 0.2;
            transform: scale(0.65);
        }

        /* Simplified Sidebar Navigation - industrial with rounded */
        .level-nav-btn {
            display: flex;
            align-items: center;
            gap: 14px;
            width: 100%;
            padding: 14px 16px;
            border-radius: 12px;
            border: 2px solid transparent;
            background: rgba(18, 18, 18, 0.6);
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: left;
        }

        .level-nav-btn:hover {
            background: rgba(26, 26, 26, 0.9);
            border-color: #333;
        }

        .level-nav-btn.active {
            background: #1a1a1a;
            border-color: #dc2626;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.15);
        }

        .level-nav-text {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .level-nav-title {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 15px;
            font-weight: 600;
            color: #e5e5e5;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .level-nav-sub {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 12px;
            color: #666;
            font-weight: 400;
        }

        .level-nav-btn.active .level-nav-title {
            color: #dc2626;
        }

        /* ===== INDICADORES DE DIFICULTAD ===== */
        .difficulty-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 9px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'IBM Plex Mono', monospace;
        }

        .difficulty-basic {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .difficulty-intermediate {
            background: rgba(234, 179, 8, 0.2);
            color: #eab308;
            border: 1px solid rgba(234, 179, 8, 0.3);
        }

        .difficulty-advanced {
            background: rgba(220, 38, 38, 0.2);
            color: #dc2626;
            border: 1px solid rgba(220, 38, 38, 0.3);
        }

        .level-nav-btn {
            position: relative;
        }

        /* Simple mode buttons - industrial with rounded */
        .mode-btn-simple, .progression-btn-simple {
            padding: 10px 16px;
            border-radius: 8px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            border: 2px solid #333;
            background: #151515;
            color: #999;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mode-btn-simple:hover, .progression-btn-simple:hover {
            border-color: #666;
            color: #fafafa;
            background: #1a1a1a;
        }

        .mode-btn-simple.active, .progression-btn-simple.active {
            background: #fafafa;
            color: #0a0a0a;
            border-color: #fafafa;
            font-weight: 700;
        }

        /* Ear training exercise tabs */
        .ear-exercise-tab {
            padding: 10px 16px;
            border-radius: 8px;
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 14px;
            font-weight: 600;
            border: 2px solid #333;
            background: #151515;
            color: #888;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .ear-exercise-tab:hover {
            border-color: #dc2626;
            color: #e5e5e5;
        }

        .ear-exercise-tab.active {
            background: #dc2626;
            border-color: #dc2626;
            color: #fafafa;
        }

        /* Scale category buttons - industrial with rounded */
        .scale-cat-btn {
            padding: 8px 14px;
            border-radius: 8px;
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 13px;
            font-weight: 600;
            border: 2px solid #333;
            background: #151515;
            color: #888;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .scale-cat-btn:hover {
            border-color: #d4a574;
            color: #d4a574;
        }

        .scale-cat-btn.active {
            background: #d4a574;
            color: #0a0a0a;
            border-color: #d4a574;
            font-weight: 700;
        }

        /* Scale list item - industrial with rounded */
        .scale-list-item {
            padding: 12px 14px;
            border-radius: 10px;
            border: 2px solid #252525;
            background: #151515;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .scale-list-item:hover {
            border-color: #444;
            background: #1a1a1a;
        }

        .scale-list-item.active {
            border-color: #dc2626;
            background: rgba(220, 38, 38, 0.08);
        }

        .scale-list-item .scale-name {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 15px;
            font-weight: 600;
            color: #fafafa;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .scale-list-item .scale-emotion {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 12px;
            color: #666;
            margin-top: 4px;
            font-weight: 400;
        }

        /* Scale info box - REFINED MINIMAL OVERRIDE */
        .scale-info-box {
            background: none;
            border: none;
            border-radius: 0;
            padding: var(--spacing-lg) 0;
            position: relative;
            box-shadow: none;
        }

        .scale-info-box::before {
            display: none;
        }

        .scale-info-box .info-header {
            border-bottom: 1px solid #333;
            padding-bottom: 16px;
            margin-bottom: 16px;
        }

        .scale-info-box .info-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 28px;
            color: #dc2626;
            letter-spacing: 2px;
            margin-bottom: 8px;
        }

        .scale-info-box .info-emotion {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 15px;
            color: #e5e5e5;
            font-style: italic;
        }

        .scale-info-box .info-section {
            background: none;
            border: none;
            border-radius: 0;
            padding: var(--spacing-md) 0;
            margin-bottom: var(--spacing-md);
        }

        .scale-info-box .info-section.accent {
            border-left: none;
        }

        .scale-info-box .info-label {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.45);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: var(--spacing-sm);
        }

        .scale-info-box .info-value {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 18px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.85);
            line-height: 1.6;
        }

        .scale-info-box .info-value.highlight {
            color: #dc2626;
        }

        .scale-info-box .info-description {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 15px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: var(--spacing-sm);
            line-height: 1.5;
        }

        .scale-info-box .brightness-bar {
            height: 8px;
            background: #1a1a1a;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid #333;
        }

        .scale-info-box .brightness-fill {
            height: 100%;
            border-radius: 4px;
            background: linear-gradient(90deg, #333 0%, #dc2626 50%, #d4a574 100%);
            transition: width 0.5s ease;
        }

        .scale-info-box .context-tag {
            display: inline-block;
            padding: 6px 12px;
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 12px;
            font-weight: 600;
            color: #ccc;
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 20px;
            margin: 3px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .scale-info-box .parent-scale-box {
            background: linear-gradient(90deg, rgba(220, 38, 38, 0.15) 0%, transparent 100%);
            border-left: 4px solid #dc2626;
            border-radius: 8px;
            padding: 12px 14px;
        }

        /* Harmonization chord buttons - matching app theme */
        .harm-chord-btn {
            padding: 12px 16px;
            border-radius: 10px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            border: 2px solid #333;
            background: #151515;
            color: #ccc;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: center;
            min-width: 64px;
        }

        .harm-chord-btn:hover {
            border-color: #dc2626;
            color: #fafafa;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .harm-chord-btn.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.4);
        }

        .harm-chord-btn.type-maj {
            border-color: #22c55e30;
        }
        .harm-chord-btn.type-maj:hover, .harm-chord-btn.type-maj.active {
            border-color: #22c55e;
            box-shadow: 0 0 12px rgba(34, 197, 94, 0.3);
        }

        .harm-chord-btn.type-min {
            border-color: #3b82f630;
        }
        .harm-chord-btn.type-min:hover, .harm-chord-btn.type-min.active {
            border-color: #3b82f6;
            box-shadow: 0 0 12px rgba(59, 130, 246, 0.3);
        }

        .harm-chord-btn.type-dim {
            border-color: #dc262630;
        }
        .harm-chord-btn.type-dim:hover, .harm-chord-btn.type-dim.active {
            border-color: #dc2626;
            box-shadow: 0 0 12px rgba(220, 38, 38, 0.3);
        }

        .harm-chord-btn .chord-quality {
            font-size: 10px;
            opacity: 0.7;
            display: block;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-top: 4px;
        }

        /* Scale comparison colors - industrial */
        .note-common { color: #4ade80; }
        .note-only-first { color: #dc2626; }
        .note-only-second { color: #d4a574; }

        /* Note highlight for comparison mode */
        .note-bubble.comparison-common {
            background: #4ade80 !important;
            color: #0a0a0a !important;
            box-shadow: 0 0 0 2px #0a0a0a, 0 0 15px rgba(74, 222, 128, 0.5) !important;
        }

        .note-bubble.comparison-different {
            background: #d4a574 !important;
            color: #0a0a0a !important;
            box-shadow: 0 0 0 2px #0a0a0a, 0 0 15px rgba(212, 165, 116, 0.5) !important;
        }

        /* Custom selection styling */
        ::selection {
            background: #dc2626;
            color: #fafafa;
        }

        /* Quiz styles */
        .quiz-cat-btn {
            padding: 8px 14px;
            border-radius: 8px;
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 13px;
            font-weight: 600;
            border: 2px solid #333;
            background: #151515;
            color: #888;
            cursor: pointer;
            transition: all 0.15s ease;
            text-transform: uppercase;
        }
        .quiz-cat-btn:hover { border-color: #dc2626; color: #dc2626; }
        .quiz-cat-btn.active { background: #dc2626; color: #fafafa; border-color: #dc2626; }

        .quiz-question-box {
            background: #121212;
            border: 2px solid #333;
            border-left: 4px solid #dc2626;
            border-radius: 12px;
            padding: 24px;
            margin: 20px 0;
        }

        .quiz-option {
            padding: 12px 20px;
            border-radius: 10px;
            border: 2px solid #333;
            background: #1a1a1a;
            color: #ccc;
            cursor: pointer;
            transition: all 0.15s ease;
            margin: 8px 0;
            display: block;
            width: 100%;
            text-align: left;
        }
        .quiz-option:hover { border-color: #666; color: #fafafa; }
        .quiz-option.correct { border-color: #22c55e; background: rgba(34, 197, 94, 0.15); color: #22c55e; }
        .quiz-option.incorrect { border-color: #dc2626; background: rgba(220, 38, 38, 0.15); color: #dc2626; }
        .quiz-option.disabled { pointer-events: none; opacity: 0.6; }

        /* Song card */
        .song-card {
            background: #121212;
            border: 2px solid #252525;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.15s ease;
            min-width: 200px;
        }
        .song-card:hover { border-color: #444; transform: translateY(-2px); }
        .song-card.active { border-color: #dc2626; box-shadow: 0 0 20px rgba(220, 38, 38, 0.2); }

        .genre-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .genre-badge.metal { background: #991b1b; color: #fafafa; }
        .genre-badge.prog { background: #7c3aed; color: #fafafa; }
        .genre-badge.rock { background: #d97706; color: #fafafa; }
        .genre-badge.blues { background: #1e40af; color: #fafafa; }
        .genre-badge.jazz { background: #a67c52; color: #0a0a0a; }
        .genre-badge.funk { background: #9333ea; color: #fafafa; }
        .genre-badge.pop { background: #dc2626; color: #fafafa; }
        .genre-badge.latin { background: #b91c1c; color: #fafafa; }
        .genre-badge.country { background: #92400e; color: #fafafa; }
        .genre-badge.reggae { background: #166534; color: #fafafa; }
        .genre-badge.grunge { background: #333333; color: #fafafa; }

        /* Lick Library Styles */
        .lick-library-container {
            padding: 20px;
        }

        .library-header {
            margin-bottom: 24px;
        }

        .library-filters {
            background: #121212;
            border: 2px solid #252525;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-select {
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 8px;
            color: #e5e5e5;
            padding: 8px 12px;
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .filter-select:hover {
            border-color: #dc2626;
        }

        .filter-select:focus {
            outline: none;
            border-color: #dc2626;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }

        .lick-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .lick-card {
            background: #121212;
            border: 2px solid #252525;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .lick-card:hover {
            border-color: #dc2626;
            transform: translateY(-4px);
            box-shadow: 0 4px 20px rgba(220, 38, 38, 0.2);
        }

        .lick-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lick-icon {
            font-size: 32px;
        }

        .lick-difficulty {
            font-size: 11px;
            font-weight: 700;
            font-family: 'IBM Plex Mono', monospace;
            letter-spacing: 0.5px;
        }

        .lick-card-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 20px;
            color: #fafafa;
            line-height: 1.2;
        }

        .lick-card-meta {
            display: flex;
            gap: 12px;
            font-size: 12px;
            color: #888;
            font-family: 'IBM Plex Mono', monospace;
        }

        .lick-genre {
            text-transform: uppercase;
            font-weight: 600;
        }

        .lick-bpm {
            color: #dc2626;
            font-weight: 600;
        }

        .lick-card-description {
            font-size: 14px;
            color: #aaa;
            line-height: 1.5;
            flex-grow: 1;
        }

        .lick-view-btn {
            margin-top: auto;
        }

        /* Lick Modal */
        .lick-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .lick-modal.hidden {
            display: none;
        }

        /* Chord Lab Styles */
        .chord-lab-mode-btn {
            padding: 0.5rem 1rem;
            background: transparent;
            color: #94a3b8;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chord-lab-mode-btn:hover {
            color: #cbd5e1;
        }

        .chord-lab-mode-btn.active {
            color: #dc2626;
            border-bottom-color: #dc2626;
        }

        .chord-lab-quality-btn,
        .chord-lab-filter-btn {
            padding: 0.375rem 0.75rem;
            background: #171717;
            color: #a3a3a3;
            border: 1px solid #262626;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .chord-lab-quality-btn:hover,
        .chord-lab-filter-btn:hover {
            background: #262626;
            border-color: #404040;
        }

        .chord-lab-quality-btn.active,
        .chord-lab-filter-btn.active {
            background: #dc2626;
            color: #fafafa;
            border-color: #dc2626;
        }

        .chord-lab-voicing-card {
            background: #0a0a0a;
            border: 1px solid #262626;
            border-radius: 0.5rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .chord-lab-voicing-card:hover {
            border-color: #404040;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        .chord-lab-voicing-card.selected {
            border-color: #dc2626;
            border-width: 2px;
            background: rgba(220, 38, 38, 0.1);
        }

        .chord-lab-voicing-card.compare-a {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }

        .chord-lab-voicing-card.compare-b {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.05);
        }

        .chord-lab-voicing-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .chord-lab-voicing-title {
            font-weight: 600;
            color: #fafafa;
            font-size: 1rem;
        }

        .chord-lab-voicing-subtitle {
            font-size: 0.75rem;
            color: #737373;
            margin-top: 0.125rem;
        }

        .chord-lab-play-btn {
            padding: 0.375rem 0.75rem;
            background: #171717;
            color: #fafafa;
            border: 1px solid #404040;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .chord-lab-play-btn:hover {
            background: #262626;
            border-color: #525252;
        }

        .chord-lab-metadata {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #262626;
            font-size: 0.875rem;
        }

        .chord-lab-metadata-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.375rem;
            color: #737373;
        }

        .chord-lab-metadata-label {
            font-weight: 500;
        }

        .chord-lab-metadata-value {
            color: #d4d4d4;
        }

        .initial-chord-btn {
            padding: 1rem;
            background: #1e293b;
            color: #cbd5e1;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .initial-chord-btn:hover {
            background: #334155;
            border-color: #84cc16;
            transform: translateY(-2px);
        }

        .emotion-btn {
            padding: 1rem;
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .emotion-btn:hover {
            background: #334155;
            border-color: #84cc16;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(132, 204, 22, 0.2);
        }

        .suggestion-card {
            padding: 1rem;
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }

        .suggestion-card:hover {
            border-color: #84cc16;
            box-shadow: 0 4px 12px rgba(132, 204, 22, 0.2);
        }

        .progression-chord-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            background: #334155;
            border: 1px solid #475569;
            border-radius: 0.375rem;
        }

        .progression-chord-chip .chord-name {
            font-weight: 600;
            color: #84cc16;
        }

        .progression-chord-chip .remove-chord {
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            font-size: 1.25rem;
            line-height: 1;
            padding: 0;
        }

        .progression-chord-chip .remove-chord:hover {
            color: #ef4444;
        }

        .ctrl-btn-small {
            padding: 0.375rem 0.75rem;
            background: #84cc16;
            color: #0a0a0a;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .ctrl-btn-small:hover {
            background: #a3e635;
        }

        .chord-lab-difficulty-bar {
            height: 6px;
            background: #262626;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.25rem;
        }

        .chord-lab-difficulty-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #d946ef, #dc2626);
            transition: width 0.3s;
        }

        .chord-lab-exercise-btn {
            padding: 1.5rem;
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .chord-lab-exercise-btn:hover {
            border-color: #84cc16;
            background: #334155;
        }

        /* Progression Lab Pro Styles */
        .progression-mode-btn {
            padding: 0.5rem 1rem;
            background: transparent;
            color: #94a3b8;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .progression-mode-btn:hover {
            color: #cbd5e1;
        }

        .progression-mode-btn.active {
            color: #84cc16;
            border-bottom-color: #84cc16;
        }

        .initial-chord-btn {
            padding: 0.75rem;
            background: #1e293b;
            color: #cbd5e1;
            border: 1px solid #334155;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
            font-weight: 500;
            text-align: center;
        }

        .initial-chord-btn:hover {
            background: #334155;
            border-color: #84cc16;
            transform: translateY(-1px);
        }

        .emotion-btn {
            padding: 1rem;
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .emotion-btn:hover {
            border-color: #84cc16;
            background: #334155;
            transform: translateY(-2px);
        }

        .emotion-btn.selected {
            border-color: #84cc16;
            background: rgba(132, 204, 22, 0.1);
        }

        .suggestion-card {
            padding: 1rem;
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .suggestion-card:hover {
            border-color: #84cc16;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(132, 204, 22, 0.2);
        }

        .suggestion-card.excellent {
            border-color: #10b981;
        }

        .suggestion-card.good {
            border-color: #f59e0b;
        }

        .suggestion-card.interesting {
            border-color: #3b82f6;
        }

        .suggestion-card.unexpected {
            border-color: #ef4444;
        }

        .progression-chord-item {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 0.375rem;
            font-weight: 500;
            position: relative;
        }

        .progression-chord-item:hover {
            border-color: #84cc16;
        }

        .progression-chord-item .function-label {
            font-size: 0.625rem;
            color: #94a3b8;
            position: absolute;
            top: -0.5rem;
            left: 0.5rem;
            background: #0f172a;
            padding: 0 0.25rem;
        }

        .progression-chord-item .remove-btn {
            color: #94a3b8;
            cursor: pointer;
            font-size: 0.875rem;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            transition: all 0.2s;
        }

        .progression-chord-item .remove-btn:hover {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .free-mode-chord-btn {
            padding: 0.75rem;
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            font-size: 0.875rem;
            font-weight: 500;
            position: relative;
        }

        .free-mode-chord-btn:hover {
            transform: translateY(-1px);
        }

        .free-mode-chord-btn.compat-excellent {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.05);
        }

        .free-mode-chord-btn.compat-good {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.05);
        }

        .free-mode-chord-btn.compat-interesting {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }

        .free-mode-chord-btn.compat-unexpected {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.05);
        }

        .free-mode-chord-btn .compat-badge {
            position: absolute;
            top: -0.375rem;
            right: -0.375rem;
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
            font-size: 0.625rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* FASE 4: Estilos para badges de extensiones */
        .extension-badge {
            display: inline-block;
            font-size: 0.625rem;
            color: #f59e0b;
            background: rgba(245, 158, 11, 0.15);
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            margin-top: 0.25rem;
            font-weight: 600;
        }

        .emotional-tags {
            font-size: 0.625rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        .chord-analysis-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            padding: 0.5rem;
            background: #1e293b;
            border-radius: 0.375rem;
            border: 1px solid #334155;
        }

        .chord-function {
            font-size: 0.75rem;
            color: #94a3b8;
            font-weight: 600;
        }

        .extensions-badge {
            font-size: 0.625rem;
            color: #f59e0b;
            background: rgba(245, 158, 11, 0.15);
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            width: fit-content;
            font-weight: 600;
        }

        #voice-leading-viz {
            position: relative;
        }

        .voice-line {
            stroke-width: 2;
            opacity: 0.7;
            transition: all 0.3s;
        }

        .voice-line.smooth {
            stroke: #10b981;
        }

        .voice-line.moderate {
            stroke: #f59e0b;
        }

        .voice-line.challenging {
            stroke: #ef4444;
        }

        /* Chord Builder Styles */
        .chord-builder-fret {
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 4px;
            color: #94a3b8;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chord-builder-fret:hover {
            background: #334155;
            border-color: #84cc16;
            transform: scale(1.1);
        }

        .chord-builder-fret.selected {
            background: #84cc16;
            border-color: #84cc16;
            color: #0a0a0a;
            font-weight: 600;
            transform: scale(1.15);
        }

        #chord-lab-caged-svg-container svg {
            max-width: 600px;
            height: 600px;
        }

        .caged-node {
            cursor: pointer;
            transition: all 0.2s;
        }

        .caged-node:hover circle {
            fill: #a3e635;
        }

        .caged-node.active circle {
            fill: #84cc16;
            stroke-width: 3;
        }

        .caged-connection {
            cursor: pointer;
            transition: all 0.2s;
        }

        .caged-connection:hover {
            stroke: #84cc16;
            stroke-width: 3;
        }

        .lick-modal-content {
            background: #0a0a0a;
            border: 2px solid #333;
            border-radius: 16px;
            padding: 32px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .lick-modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: #dc2626;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            font-size: 24px;
            color: #fff;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        .lick-modal-close:hover {
            background: #b91c1c;
            transform: rotate(90deg);
        }

        .lick-detail-meta {
            font-family: 'Barlow Condensed', sans-serif;
        }

        /* Tab Notation Styles */
        .tab-notation-container {
            background: #121212;
            border: 2px solid #333;
            border-radius: 12px;
            padding: 20px;
        }

        .tab-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 18px;
            color: #dc2626;
            margin-bottom: 12px;
        }

        .tab-notation-svg {
            display: block;
            margin: 0 auto;
        }

        .tab-controls {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #333;
        }

        .tab-play-btn,
        .tab-loop-btn {
            background: #dc2626;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .tab-play-btn:hover,
        .tab-loop-btn:hover {
            background: #b91c1c;
            transform: translateY(-1px);
        }

        .tab-loop-btn.active {
            background: #10b981;
        }

        .tempo-control {
            display: flex;
            flex-direction: column;
            gap: 4px;
            flex-grow: 1;
        }

        .tempo-control label {
            font-size: 12px;
            color: #888;
            font-family: 'Barlow Condensed', sans-serif;
        }

        .tempo-value {
            color: #dc2626;
            font-weight: 700;
        }

        .tempo-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #333;
            outline: none;
            -webkit-appearance: none;
        }

        .tempo-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #dc2626;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .tempo-slider::-webkit-slider-thumb:hover {
            background: #b91c1c;
            transform: scale(1.2);
        }

        .tempo-slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #dc2626;
            cursor: pointer;
            border: none;
            transition: all 0.15s ease;
        }

        .tempo-slider::-moz-range-thumb:hover {
            background: #b91c1c;
            transform: scale(1.2);
        }

        /* Estilo compartido para sliders BPM - reutiliza .tempo-slider */
        #metronomeBPMSlider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #333;
            outline: none;
            -webkit-appearance: none;
        }

        #metronomeBPMSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #dc2626;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        #metronomeBPMSlider::-webkit-slider-thumb:hover {
            background: #b91c1c;
            transform: scale(1.2);
        }

        #metronomeBPMSlider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #dc2626;
            cursor: pointer;
            border: none;
            transition: all 0.15s ease;
        }

        #metronomeBPMSlider::-moz-range-thumb:hover {
            background: #b91c1c;
            transform: scale(1.2);
        }

        .mini-fretboard {
            background: #0a0a0a;
            padding: 20px;
            border-radius: 8px;
        }

        /* Extended chord matrix */
        .ext-matrix-grid {
            display: grid;
            grid-template-columns: auto repeat(4, 1fr);
            gap: 6px;
            max-width: 500px;
        }
        .ext-matrix-corner { }
        .ext-matrix-col-header {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 11px;
            font-weight: 700;
            color: #d4a574;
            text-transform: uppercase;
            text-align: center;
            padding: 4px 0;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .ext-matrix-row-header {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 18px;
            color: #dc2626;
            display: flex;
            align-items: center;
            justify-content: center;
            padding-right: 8px;
        }
        .ext-matrix-btn {
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 8px;
            color: #e5e5e5;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            padding: 8px 6px;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .ext-matrix-btn:hover {
            border-color: #dc2626;
            background: #252525;
            color: #fafafa;
        }
        .ext-matrix-btn.active {
            background: #dc2626;
            border-color: #dc2626;
            color: #fafafa;
            box-shadow: 0 0 12px rgba(220, 38, 38, 0.3);
        }
        .ext-matrix-btn.non-essential {
            opacity: 0.5;
            border-style: dashed;
        }
        .ext-matrix-btn.non-essential:hover {
            opacity: 0.8;
        }

        /* Badge esencial - Metallic foil effect */
        .essential-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #d4af37 100%);
            color: #1a1000;
            font-size: 9px;
            font-weight: 900;
            padding: 3px 7px;
            border-radius: 5px;
            margin-left: 5px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            box-shadow:
                0 2px 8px rgba(255, 215, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.4),
                inset 0 -1px 2px rgba(0, 0, 0, 0.3);
            position: relative;
            animation: badge-shimmer 3s ease-in-out infinite;
            text-shadow: 0 1px 1px rgba(255, 255, 255, 0.3);
        }

        @keyframes badge-shimmer {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        /* Voicings múltiples - Premium card design */
        .voicings-container {
            background:
                linear-gradient(135deg, #0f0f0f 0%, #0a0a0a 100%);
            border: 1px solid #2a2a2a;
            border-radius: 16px;
            padding: 24px;
            margin-top: 20px;
            box-shadow:
                0 8px 24px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
        }

        .voicings-header {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 22px;
            color: #dc2626;
            margin-bottom: 0;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            position: relative;
            padding-bottom: 10px;
        }

        .voicings-header-toggle:hover {
            color: #ef4444;
        }

        .voicings-scroll:not([style*="display: none"]) {
            margin-top: 16px;
        }

        .voicings-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, #dc2626 0%, transparent 100%);
        }

        .voicings-scroll {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding-bottom: 12px;
            scrollbar-width: thin;
            scrollbar-color: #dc2626 #1a1a1a;
        }

        .voicings-scroll::-webkit-scrollbar {
            height: 8px;
        }

        .voicings-scroll::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 4px;
        }

        .voicings-scroll::-webkit-scrollbar-thumb {
            background: #dc2626;
            border-radius: 4px;
        }

        .voicing-item {
            flex-shrink: 0;
            background:
                linear-gradient(135deg, #1a1a1a 0%, #141414 100%);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 16px;
            min-width: 170px;
            text-align: center;
            box-shadow:
                0 4px 12px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .voicing-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(220, 38, 38, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .voicing-item:hover {
            transform: translateY(-4px);
            border-color: #dc2626;
            box-shadow:
                0 8px 24px rgba(220, 38, 38, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .voicing-item:hover::before {
            left: 100%;
        }

        .voicing-name {
            font-size: 13px;
            color: #f5f5f5;
            font-weight: 700;
            margin-bottom: 12px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-family: 'Barlow Condensed', sans-serif;
        }

        .voicing-difficulty {
            display: inline-block;
            font-size: 10px;
            font-weight: 800;
            padding: 5px 10px;
            border-radius: 6px;
            margin-top: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;
        }

        .voicing-difficulty.easy {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: #000;
            box-shadow:
                0 2px 8px rgba(34, 197, 94, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .voicing-difficulty.medium {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1a1000;
            box-shadow:
                0 2px 8px rgba(251, 191, 36, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .voicing-difficulty.advanced {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: #fff;
            box-shadow:
                0 2px 8px rgba(239, 68, 68, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .voicing-item:hover .voicing-difficulty {
            transform: scale(1.05);
        }

        /* Comparador de tensiones - Distinct visual identity */
        .tension-comparator {
            position: relative;
            background:
                linear-gradient(135deg, rgba(139, 92, 246, 0.12) 0%, rgba(107, 33, 168, 0.08) 100%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 50%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 14px;
            padding: 18px;
            margin-bottom: 20px;
            box-shadow:
                0 4px 16px rgba(107, 33, 168, 0.25),
                inset 0 1px 0 rgba(139, 92, 246, 0.1);
            overflow: hidden;
        }

        .tension-comparator::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.1) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
        }

        .tension-comparator .text-sm {
            position: relative;
            z-index: 1;
        }

        .tension-btn {
            background:
                linear-gradient(135deg, #1a1a1a 0%, #141414 100%);
            border: 2px solid #7c3aed;
            border-radius: 10px;
            color: #c4b5fd;
            font-size: 13px;
            font-weight: 700;
            padding: 10px 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .tension-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.4) 0%, transparent 70%);
            transform: translate(-50%, -50%);
            border-radius: 50%;
            transition: width 0.5s ease, height 0.5s ease;
        }

        .tension-btn:hover {
            background:
                linear-gradient(135deg, #6b21a8 0%, #5b21a8 100%);
            color: #fff;
            border-color: #8b5cf6;
            transform: translateY(-2px);
            box-shadow:
                0 4px 16px rgba(107, 33, 168, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .tension-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .tension-btn.active {
            background:
                linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
            color: #fff;
            border-color: #a78bfa;
            box-shadow:
                0 6px 20px rgba(124, 58, 237, 0.6),
                inset 0 2px 4px rgba(255, 255, 255, 0.2),
                0 0 20px rgba(139, 92, 246, 0.4);
            animation: pulse-glow 1.5s ease-in-out;
        }

        @keyframes pulse-glow {
            0%, 100% {
                box-shadow:
                    0 6px 20px rgba(124, 58, 237, 0.6),
                    inset 0 2px 4px rgba(255, 255, 255, 0.2),
                    0 0 20px rgba(139, 92, 246, 0.4);
            }
            50% {
                box-shadow:
                    0 6px 20px rgba(124, 58, 237, 0.8),
                    inset 0 2px 4px rgba(255, 255, 255, 0.3),
                    0 0 30px rgba(139, 92, 246, 0.6);
            }
        }

        /* Extended chord info */
        .ext-chord-info {
            background: #121212;
            border: 2px solid #333;
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
        }

        /* Secondary dominant arrows */
        .sec-dom-arrow {
            font-size: 24px;
            color: #666;
            margin: 0 8px;
        }

        .sec-dom-chord {
            padding: 12px 16px;
            border-radius: 10px;
            border: 2px solid #333;
            background: #1a1a1a;
            text-align: center;
            min-width: 60px;
        }
        .sec-dom-chord.dominant { border-color: #d97706; background: rgba(217, 119, 6, 0.1); }
        .sec-dom-chord.target { border-color: #22c55e; background: rgba(34, 197, 94, 0.1); }

        /* Additional visual enhancements */
        .section-divider {
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, #333 20%, #333 80%, transparent 100%);
            margin: 20px 0;
        }

        /* Glow effects for important elements */
        .glow-red {
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.4);
        }

        .glow-white {
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        /* Border accents */
        .border-accent-left {
            border-left: 4px solid #dc2626;
        }

        .border-accent-top {
            border-top: 2px solid #dc2626;
        }

        /* Text utilities */
        .text-display {
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 2px;
        }

        .text-mono {
            font-family: 'IBM Plex Mono', monospace;
        }

        .text-body {
            font-family: 'Barlow Condensed', sans-serif;
        }

        /* Subtle hover states for interactive elements */
        .hover-lift:hover {
            transform: translateY(-2px);
        }

        .hover-glow:hover {
            box-shadow: 0 0 25px rgba(220, 38, 38, 0.3);
        }

        /* Responsive styles for chord diagrams */
        /* Mobile adjustments for sticky fretboard */
        @media (max-width: 768px) {
            .fretboard-sticky-wrapper {
                top: 56px;
                padding: 0.5rem 0;
            }

            .diagrams-container {
                gap: 12px;
            }

            .chord-diagram {
                min-width: 140px;
                max-width: 160px;
            }
        }

        /* Mobile landscape: compact sticky fretboard */
        @media (max-width: 768px) and (orientation: landscape) {
            .fretboard-sticky-wrapper {
                top: 48px;
                padding: 0.25rem 0;
            }

            .fretboard-container {
                max-height: 40vh;
            }
        }

        /* Mobile portrait: disable sticky to save space */
        @media (max-width: 768px) and (orientation: portrait) {
            .fretboard-sticky-wrapper {
                position: relative;
                top: auto;
            }
        }

        @media (max-width: 480px) {
            .diagrams-container {
                flex-direction: column;
                flex-wrap: nowrap;
            }

            .chord-diagram {
                width: 100%;
                max-width: 280px;
            }

            .diagrams-container.scrollable-horizontal {
                flex-direction: column;
                overflow-x: hidden;
            }
        }

        /* Toggle switch styles para el toggle de batería */
        .slider {
            position: relative;
            display: block;
            cursor: pointer;
            user-select: none;
        }

        .slider .dot {
            transition: transform 0.3s ease;
        }

        input[type="checkbox"]:checked + .slider {
            background-color: #dc2626 !important;
        }

        input[type="checkbox"]:checked + .slider .dot {
            transform: translateX(24px) !important;
        }

        input[type="checkbox"]:not(:checked) + .slider {
            background-color: #404040 !important;
        }

        input[type="checkbox"]:not(:checked) + .slider .dot {
            transform: translateX(0) !important;
        }

        /* Estilos para el slider de BPM */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            background: #333;
            border-radius: 3px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #dc2626;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(220, 38, 38, 0.5);
        }

        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #dc2626;
            cursor: pointer;
            border-radius: 50%;
            border: none;
            box-shadow: 0 0 10px rgba(220, 38, 38, 0.5);
        }

        input[type="range"]:hover::-webkit-slider-thumb {
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.8);
        }

        input[type="range"]:hover::-moz-range-thumb {
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.8);
        }

        /* Toast notifications */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            min-width: 300px;
            max-width: 400px;
            background: #1a1a1a;
            border: 2px solid #333;
            border-left: 4px solid #dc2626;
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            transform: translateX(500px);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.toast-success {
            border-left-color: #22c55e;
        }

        .toast.toast-error {
            border-left-color: #dc2626;
        }

        .toast.toast-info {
            border-left-color: #3b82f6;
        }

        .toast.toast-warning {
            border-left-color: #f59e0b;
        }

        .toast-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .toast-content {
            flex: 1;
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 14px;
            color: #e5e5e5;
            line-height: 1.5;
        }

        .toast-success .toast-icon { color: #22c55e; }
        .toast-error .toast-icon { color: #dc2626; }
        .toast-info .toast-icon { color: #3b82f6; }
        .toast-warning .toast-icon { color: #f59e0b; }

        /* Loading spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #333;
            border-top-color: #dc2626;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== MICRO-INTERACCIONES Y ANIMACIONES ===== */

        /* Animación suave al cambiar contenido del fretboard */
        @keyframes contentChange {
            0% { opacity: 0.85; transform: scale(0.99); }
            100% { opacity: 1; transform: scale(1); }
        }

        .fretboard-container.updating {
            animation: contentChange 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Hover effect mejorado para botones de acordes/notas */
        [data-chord]:hover:not(.active),
        [data-note]:hover:not(.active),
        [data-interval]:hover:not(.active) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.15);
        }

        /* Pulso sutil en botones activos */
        [data-chord].active,
        [data-note].active,
        [data-interval].active {
            animation: gentlePulse 2s ease-in-out infinite;
        }

        @keyframes gentlePulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.1); }
        }

        /* Transición suave al cambiar de nivel */
        #content {
            transition: opacity 0.2s ease-in-out;
        }

        #content.level-changing {
            opacity: 0.6;
        }

        /* Efecto hover mejorado para level buttons */
        .level-btn {
            position: relative;
            overflow: hidden;
        }

        .level-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(220, 38, 38, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .level-btn:hover::before {
            left: 100%;
        }

        /* Bounce sutil en botones de play */
        .ctrl-play:active:not(:disabled) {
            animation: buttonBounce 0.3s ease;
        }

        @keyframes buttonBounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(0.95); }
        }

        /* Smooth transitions para toggles */
        .toggle-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Ripple effect para clicks en botones importantes */
        .ctrl-btn:active:not(:disabled) {
            position: relative;
        }

        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(10, 10, 10, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .loading-overlay.show {
            opacity: 1;
            pointer-events: all;
        }

        .loading-content {
            text-align: center;
        }

        .loading-content .loading-spinner {
            width: 60px;
            height: 60px;
            border-width: 4px;
            margin-bottom: 20px;
        }

        .loading-content .loading-text {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 20px;
            color: #fafafa;
            letter-spacing: 2px;
        }

        /* ========================================
           RESPONSIVE STYLES - MOBILE OPTIMIZATION
           ======================================== */

        /* Tablet (768px - 1024px) */
        @media (max-width: 1024px) {
            aside {
                width: 200px;
            }

            .level-nav-btn {
                padding: 12px;
            }

            .level-nav-title {
                font-size: 14px;
            }

            .level-nav-sub {
                font-size: 11px;
            }

            header {
                padding: 0 16px;
                flex-wrap: wrap;
                height: auto;
                min-height: 64px;
            }

            .fret {
                min-width: 50px;
            }

            .lick-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        /* Mobile Landscape (480px - 768px) */
        @media (max-width: 768px) {
            /* Hide sidebar on mobile, show as overlay when needed */
            aside {
                position: fixed;
                left: -280px;
                top: 0;
                height: 100vh;
                width: 280px;
                z-index: 1000;
                transition: left 0.3s ease;
            }

            aside.mobile-open {
                left: 0;
                box-shadow: 4px 0 20px rgba(0,0,0,0.5);
            }

            /* Mobile menu button */
            body::after {
                content: '☰';
                position: fixed;
                top: 16px;
                left: 16px;
                width: 44px;
                height: 44px;
                background: #dc2626;
                color: #fff;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 24px;
                cursor: pointer;
                z-index: 999;
            }

            main {
                margin-left: 0;
            }

            header {
                flex-direction: column;
                gap: 12px;
                padding: 12px;
            }

            header > div {
                width: 100%;
                justify-content: space-between;
            }

            /* Touch targets minimum 44x44px */
            button, .ctrl-btn, .mode-btn-simple, .scale-cat-btn {
                min-height: 44px;
                min-width: 44px;
                padding: 12px 16px;
            }

            .note-bubble {
                width: 44px;
                height: 44px;
                font-size: 14px;
            }

            /* Stack controls vertically */
            .flex.gap-3, .flex.gap-4, .flex.gap-6 {
                flex-direction: column;
                gap: 12px;
            }

            /* Fretboard adjustments */
            .fret {
                min-width: 40px;
            }

            /* Lick Library mobile */
            .lick-grid {
                grid-template-columns: 1fr;
            }

            .lick-modal-content {
                padding: 20px;
                max-height: 95vh;
            }

            /* Ear training mobile */
            #earTrainingAnswers {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .ear-exercise-tab {
                font-size: 12px;
                padding: 8px 12px;
            }

            /* Jam Session mobile adaptations */
            .jam-session-layout {
                flex-direction: column;
            }

            .jam-sidebar {
                width: 100%;
                max-height: 40vh;
                overflow-y: auto;
            }

            .jam-content {
                width: 100%;
            }

            .jam-track-grid {
                grid-template-columns: 1fr;
            }

            .jam-keyinfo-bar {
                flex-direction: column;
                gap: 8px;
                padding: 12px;
            }

            .jam-controls {
                flex-direction: column;
                gap: 12px;
            }
        }

        /* Mobile Portrait (< 480px) */
        @media (max-width: 480px) {
            /* Fluid typography */
            h1, .text-3xl { font-size: clamp(20px, 5vw, 28px); }
            h2, .text-2xl { font-size: clamp(18px, 4vw, 24px); }
            h3, .text-xl { font-size: clamp(16px, 3.5vw, 20px); }
            .text-lg { font-size: clamp(14px, 3vw, 18px); }
            .text-base { font-size: clamp(12px, 2.5vw, 16px); }
            .text-sm { font-size: clamp(11px, 2vw, 14px); }
            .text-xs { font-size: clamp(10px, 1.8vw, 12px); }

            /* Vertical fretboard option */
            .fretboard-vertical {
                transform: rotate(90deg);
                transform-origin: center;
                width: 100vh;
                height: 100vw;
                position: relative;
            }

            .fretboard-vertical .note-bubble {
                transform: rotate(-90deg);
            }

            /* Sidebar full width */
            aside {
                width: 100%;
                left: -100%;
            }

            aside.mobile-open {
                left: 0;
            }

            /* Single column layouts */
            .grid-cols-2, .grid-cols-3, .grid-cols-4 {
                grid-template-columns: 1fr !important;
            }

            /* Compact controls */
            .control-panel {
                padding: 12px;
            }

            /* Tab notation mobile */
            .tab-notation-svg {
                max-width: 100%;
                height: auto;
            }

            .tab-controls {
                flex-direction: column;
                gap: 8px;
            }

            .tempo-control {
                width: 100%;
            }

            /* Song cards mobile */
            .song-card {
                padding: 12px;
            }

            /* Library filters mobile */
            .library-filters {
                flex-direction: column;
                gap: 12px;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select {
                width: 100%;
            }

            /* Modal full screen on mobile */
            .lick-modal {
                padding: 0;
            }

            .lick-modal-content {
                width: 100%;
                max-width: 100%;
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
                padding: 16px;
            }

            /* Bottom drawer for Jam Session sidebar */
            .jam-sidebar-mobile-drawer {
                position: fixed;
                bottom: -60vh;
                left: 0;
                width: 100%;
                height: 60vh;
                background: #0a0a0a;
                border-top: 2px solid #333;
                transition: bottom 0.3s ease;
                z-index: 900;
                overflow-y: auto;
            }

            .jam-sidebar-mobile-drawer.open {
                bottom: 0;
            }

            /* Reduce animations on mobile for performance */
            * {
                animation-duration: 0.15s !important;
                transition-duration: 0.15s !important;
            }

            .note-bubble.pulse {
                animation: none !important;
            }

            /* Increase spacing between interactive elements */
            .flex.gap-2 {
                gap: 12px;
            }

            /* Compact header */
            header {
                padding: 8px;
            }

            .custom-select {
                font-size: 12px;
                padding: 8px;
            }

            /* Metronome controls mobile */
            .metronome-controls {
                flex-direction: column;
                gap: 12px;
            }

            #bpmDisplay {
                font-size: clamp(32px, 8vw, 48px);
            }
        }

        /* Landscape orientation specific */
        @media (max-width: 768px) and (orientation: landscape) {
            .fretboard-container {
                max-height: 60vh;
                overflow-y: auto;
            }

            aside {
                height: 100vh;
            }

            .jam-sidebar {
                max-height: 100vh;
            }
        }

        /* High DPI screens */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .note-bubble {
                border-width: 1px;
            }

            .fret {
                border-width: 2px;
            }
        }

        /* Reduce motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .note-bubble.pulse {
                animation: none !important;
            }
        }

        /* Dark mode support (already dark, but for compatibility) */
        @media (prefers-color-scheme: dark) {
            /* App is already dark themed */
        }

        /* ===== ACCESIBILIDAD: FOCUS STATES ===== */
        /* Focus visible para navegación por teclado */
        button:focus-visible,
        .ctrl-btn:focus-visible,
        .level-btn:focus-visible,
        input[type="range"]:focus-visible,
        [data-note]:focus-visible,
        [data-chord]:focus-visible,
        [data-interval]:focus-visible {
            outline: 2px solid #dc2626;
            outline-offset: 3px;
            border-radius: 4px;
        }

        /* Focus para elementos de toggle */
        .toggle-btn:focus-visible {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        /* Focus para botones de nivel con indicador más prominente */
        .level-btn:focus-visible {
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.3);
            outline: 2px solid #dc2626;
        }

        /* Remover outline default en click (solo en focus-visible) */
        button:focus:not(:focus-visible),
        .ctrl-btn:focus:not(:focus-visible),
        input:focus:not(:focus-visible) {
            outline: none;
        }

        /* Print styles */
        @media print {
            aside, header, .ctrl-btn, button {
                display: none;
            }

            .fretboard-container {
                border: 1px solid #000;
            }

            .note-bubble {
                border: 1px solid #000 !important;
            }
        }

        /* Extension tabs for level 4 */
        .extension-tab {
            padding: 0.5rem 1rem;
            background: #1a1a1a;
            color: #888;
            border: 1px solid #333;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            font-size: 14px;
        }

        .extension-tab:hover {
            background: #252525;
            color: #aaa;
        }

        .extension-tab.active {
            background: #dc2626;
            color: #fff;
            border-color: #dc2626;
        }

        /* Pentatonic sub-selector buttons */
        .penta-type-btn {
            padding: 0.5rem 1rem;
            background: #1a1a1a;
            color: #888;
            border: 1px solid #333;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            font-size: 14px;
        }

        .penta-type-btn:hover {
            background: #252525;
            color: #aaa;
        }

        .penta-type-btn.active {
            background: #dc2626;
            color: #fff;
            border-color: #dc2626;
        }
